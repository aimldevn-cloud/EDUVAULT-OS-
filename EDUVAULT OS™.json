{
  "name": "EDUVAULT OS‚Ñ¢",
  "nodes": [
    {
      "parameters": {
        "height": 1088,
        "width": 1728,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        0
      ],
      "typeVersion": 1,
      "id": "99e695cd-4e2c-4e80-9eb8-272d5a09dcfb",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "‚è∞WF_Fee_Reminder_Automation + A fault-tolerant notification system\n",
        "height": 1696,
        "width": 3136,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -16,
        2160
      ],
      "typeVersion": 1,
      "id": "8dffc606-d2b8-4fc2-aa64-2da08f66b6f1",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "jsCode": "const classes = [];\nfor (let i = 1; i <= 12; i++) {\n  classes.push({\n    json: {\n      Target_Sheet: `Class_${String(i).padStart(2,'0')}`\n    }\n  });\n}\nreturn classes;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1024,
        2976
      ],
      "id": "8907a9df-0995-4d1d-a2a5-bfac7f58bded",
      "name": "Generate Class List"
    },
    {
      "parameters": {
        "url": "=https://script.google.com/macros/s/AKfycbxo0pgWykNmBEBMNnmDGXnjNbshJkebKNAZyrXa8v_z-rYv9UnCZjonnh56KGNyNZDw/exec",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "secret",
              "value": "=LO737AIRLINESMNXmnxMNXmnx"
            },
            {
              "name": "class",
              "value": "={{$json.Target_Sheet}}"
            },
            {
              "name": "month",
              "value": "={{ $('Column_Namespace_Compiler1').item.json.monthKey }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1248,
        2976
      ],
      "id": "661be076-9401-4faa-af68-eb6fd51117b8",
      "name": "Fetch_Unpaid_Students_By_Class_And_Month"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months",
              "triggerAtDayOfMonth": 8,
              "triggerAtHour": 10,
              "triggerAtMinute": 5
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        368,
        2880
      ],
      "id": "6cf54135-93af-4a3d-b815-0782d1ddb44f",
      "name": "Medium Reminder"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months",
              "triggerAtDayOfMonth": 26,
              "triggerAtHour": 19,
              "triggerAtMinute": 5
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        160,
        2896
      ],
      "id": "48593c94-64d7-421f-a748-a5b7de7eb84b",
      "name": "Soft Reminder"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months",
              "triggerAtDayOfMonth": 10,
              "triggerAtHour": 10,
              "triggerAtMinute": 5
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        368,
        3072
      ],
      "id": "63a7f99e-5163-4d06-aba0-2c4b6b5ac9e0",
      "name": "Strong Reminder"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months",
              "triggerAtDayOfMonth": 15,
              "triggerAtHour": 10,
              "triggerAtMinute": 5
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        160,
        3056
      ],
      "id": "6b78f5ac-1621-423e-8198-f74bcf8579ab",
      "name": "Final + Report"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      ...$json,              // üëà CRON ka sara data preserve\n      reminder_type: \"SOFT\"  // üëà sirf naya field add\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        576,
        2688
      ],
      "id": "c2ae189e-5d1e-4e0d-80f2-b588af67039d",
      "name": "Set Reminder Type ‚Äì SOFT"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      ...$json,              // üëà CRON ka sara data preserve\n      reminder_type: \"MEDIUM\"  // üëà sirf naya field add\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        576,
        2880
      ],
      "id": "a11f353d-80ad-47bb-a644-91b1f278cff2",
      "name": "Set Reminder Type ‚Äì MEDIUM"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      ...$json,              // üëà CRON ka sara data preserve\n      reminder_type: \"STRONG\"  // üëà sirf naya field add\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        576,
        3072
      ],
      "id": "c2661a48-bd8f-417f-b2d3-1046e6e07281",
      "name": "Set Reminder Type ‚Äì STRONG"
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    json: {\n      ...$json,              // üëà CRON ka sara data preserve\n      reminder_type: \"FINAL+REPORT\"  // üëà sirf naya field add\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        576,
        3264
      ],
      "id": "7991d9a6-5539-4e9d-a094-37496877dd20",
      "name": "Set Reminder Type ‚Äì FINAL + REPORT"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "e4dbd721-f1da-4b34-a035-9a0be7fff427",
                    "leftValue": "={{ $('Column_Namespace_Compiler1').item.json.reminder_type }}",
                    "rightValue": "SOFT",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d0a6e93b-b30d-41aa-af92-46d99cc2f73e",
                    "leftValue": "={{ $('Column_Namespace_Compiler1').item.json.reminder_type }}",
                    "rightValue": "MEDIUM",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "c2a5f226-b563-4d7c-913d-c0f86320b724",
                    "leftValue": "={{ $('Column_Namespace_Compiler1').item.json.reminder_type }}",
                    "rightValue": "STRONG",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "7145f6ed-3fe5-4559-bbb4-69d24c81862c",
                    "leftValue": "={{ $('Column_Namespace_Compiler1').item.json.reminder_type }}",
                    "rightValue": "FINAL+REPORT",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1472,
        2944
      ],
      "id": "eb71cd29-9e07-47b8-87e8-ccf9d35bcda2",
      "name": "Route_By_Reminder_Type"
    },
    {
      "parameters": {
        "sendTo": "={{ $json.Student_Email }}",
        "subject": "=Urgent: Fee overdue for {{ $json.Full_Name }} ‚Äì Immediate action required",
        "emailType": "text",
        "message": "=Hi {{ $json.Full_Name }},\n\n\nThis is a reminder regarding your monthly fee for {{ $json.Month }}.\n  \n\n\nPlease note that continued non-payment may result in temporary restriction of academic services.  \n\n\n-------------------------------- \nStudent: {{ $json.Full_Name }} \nClass: {{ $json.Class }} \nMonthly Fee: Rs {{ $json.Monthly_Fee }} \nMonth: {{ $json.Month }}\nStatus: UNPAID \n--------------------------------  \n\n\n[ Pay Fee Now ]  \n\n\nIf there is any issue or concern, please contact the administration immediately.  \n\n\nEduVault Management",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2528,
        3648
      ],
      "id": "635f7117-72ff-42fa-b66c-16b1eb5d74b8",
      "name": "Gmail_Send_STRONG_Reminder_Student",
      "webhookId": "b8783d15-dbc6-43e0-b8a2-cc052ca7d097",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.Parent_Email }}",
        "subject": "=Urgent: Fee overdue for {{ $json.Full_Name }} ‚Äì Immediate action required",
        "emailType": "text",
        "message": "=Dear Sir/Madam, \n\n\nDespite previous reminders, the fee for {{ $json.Full_Name }} for {{ $json.Month }} remains unpaid.  \n\n\nPlease note that continued non-payment may result in temporary restriction of academic services.\n\n\n-------------------------------- \nStudent: {{ $json.Full_Name }} \nClass: {{ $json.Class }}\nMonthly Fee: Rs {{ $json.Monthly_Fee }}\nMonth: {{ $json.Month }} \nStatus: UNPAID \n--------------------------------  \n\n\n[ Pay Fee Now ]  \n\n\nIf there is any issue or concern, please contact the administration immediately.  \n\n\nEduVault Management",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2528,
        3376
      ],
      "id": "46f5354e-91ba-4a5a-b408-14c57d7e9083",
      "name": "Gmail_Send_STRONG_Reminder_Parent",
      "webhookId": "2997f61e-ec73-4dbc-ac92-540f12f2c649",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.Student_Email }}",
        "subject": "=Fee pending: {{ $json.Full_Name }}‚Äì {{ $json.Month }}",
        "emailType": "text",
        "message": "=Hi {{ $json.Full_Name }},\n\n\nThis is a reminder regarding your monthly fee for {{ $json.Month }}.\n\n\nTo avoid any inconvenience or disruption, please arrange payment at your earliest convenience.\n\n\n-------------------------------- \nStudent: {{ $json.Full_Name }} \nClass: {{ $json.Class }}\nMonthly Fee: Rs {{ $json.Monthly_Fee }} \nMonth: {{ $json.Month }}\nStatus: UNPAID \n--------------------------------  \n\n\n[ Pay Fee Button ]  \n\n\nIf payment has already been made, kindly share the receipt with us.  \n\nThank you for your cooperation,   \n\n\nEduVault Accounts Team",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2528,
        3088
      ],
      "id": "dab1d244-7332-4b90-a16a-be5e36511178",
      "name": "Gmail_Send_MEDIUM_Reminder_Student",
      "webhookId": "be1dd97d-bba6-402c-a0c2-702e108b9d01",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.Parent_Email }}",
        "subject": "=Fee pending:  {{ $json.Full_Name }}‚Äì {{ $json.Month }}",
        "emailType": "text",
        "message": "=Dear Sir/Madam,\n  \n\nOur records indicate that {{ $json.Full_Name }}‚Äôs fee for {{ $json.Month }} is still pending.  \n\n\nTo avoid any inconvenience or disruption, please arrange payment at your earliest convenience.  \n\n\n-------------------------------- \nStudent: {{ $json.Full_Name }}\nClass: {{ $json.Class }} \nMonthly Fee: Rs {{ $json.Monthly_Fee }} \nMonth:  {{ $json.Month }}\nStatus: UNPAID \n--------------------------------  \n\n\n[ Pay Fee Button ]  \n\n\nIf payment has already been made, kindly share the receipt with us.  \n\n\nThank you for your cooperation,   \nEduVault Accounts Team",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2528,
        2800
      ],
      "id": "fb566c1d-c17d-4944-bb74-a513291b4cd9",
      "name": "Gmail_Send_MEDIUM_Reminder_Parent",
      "webhookId": "971d8967-04d8-40a7-8718-39005f9fde7e",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.Student_Email }}",
        "subject": "=Gentle reminder: {{ $json.Full_Name }}‚Äôs fee for {{ $json.Month }}",
        "emailType": "text",
        "message": "=Hi {{ $json.Full_Name }},\n\n\nThis is a reminder regarding your monthly fee for {{ $json.Month }}. \n\n\nWe understand schedules can get busy ‚Äî this is simply a friendly nudge in case the payment was missed.  \n\n-------------------------------- \nStudent: {{ $json.Full_Name }}\nClass: {{ $json.Class }}\nMonthly Fee: Rs {{ $json.Monthly_Fee }}\nMonth: {{ $json.Month }}\nStatus: UNPAID\n--------------------------------  \n\n\n[Pay Fee Button ]  \n\n\nIf you‚Äôve already completed the payment, thank you ‚Äî please ignore this message.  \n\n\nWarm regards,   \nEduVault Finance Team",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2528,
        2496
      ],
      "id": "813bcc4e-d9cb-4653-85fb-3591104927cc",
      "name": "Gmail_Send_SOFT_Reminder_Student",
      "webhookId": "f8ec4b3a-eca7-4545-944c-75712de5eae2",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.Parent_Email }}",
        "subject": "=Gentle reminder: {{ $json.Full_Name }}‚Äôs fee for {{ $json.Month }}",
        "message": "=Dear **Sir / Madam**,\n\n<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\"\n  style=\"font-family:Arial,Helvetica,sans-serif; border-collapse:collapse; background:#fee2e2;\">\n\n  <!-- OUTER WRAP -->\n\n  <tr>\n    <td align=\"center\" style=\"padding:26px 0;\">\n\n```\n  <table width=\"720\" cellpadding=\"0\" cellspacing=\"0\"\n    style=\"background:#ffffff; border-radius:6px; overflow:hidden;\">\n\n    <!-- HEADER -->\n    <tr>\n      <td style=\"padding:18px; background:#7f1d1d; color:#ffffff;\">\n        <strong style=\"font-size:18px; letter-spacing:0.4px;\">\n          EDUVŒõULT OS‚Ñ¢\n        </strong><br>\n        <span style=\"font-size:12px; color:#fecaca;\">\n          Finance & Fee Compliance System\n        </span>\n      </td>\n    </tr>\n\n    <!-- BODY -->\n    <tr>\n      <td style=\"padding:22px; color:#111827;\">\n\n        <p style=\"font-size:14px; line-height:1.6;\">\n          This is a gentle but important reminder regarding the\n          <strong style=\"color:#991b1b;\">pending monthly fee</strong>\n          for the following student:\n        </p>\n\n        <!-- INFO TABLE -->\n        <table width=\"100%\" cellpadding=\"8\" cellspacing=\"0\"\n          style=\"margin:16px 0; font-size:13px; background:#fef2f2; border:1px solid #fecaca;\">\n          <tr>\n            <td width=\"180\"><strong>Student Name</strong></td>\n            <td>{{ $json.Full_Name }}</td>\n          </tr>\n          <tr>\n            <td><strong>Galaxy ID</strong></td>\n            <td>{{ $json.Galaxy_ID }}</td>\n          </tr>\n          <tr>\n            <td><strong>Class</strong></td>\n            <td>{{ $json.Class }}</td>\n          </tr>\n          <tr>\n            <td><strong>Month</strong></td>\n            <td>{{ $json.Month }}</td>\n          </tr>\n          <tr>\n            <td><strong>Monthly Fee</strong></td>\n            <td>Rs {{ $json.Monthly_Fee }}</td>\n          </tr>\n          <tr>\n            <td><strong>Payment Status</strong></td>\n            <td>\n              <strong style=\"color:#b91c1c;\">UNPAID</strong>\n            </td>\n          </tr>\n        </table>\n\n        <!-- NOTICE -->\n        <p style=\"margin-top:16px; font-size:13px; color:#7f1d1d; line-height:1.6;\">\n          Please arrange payment at your earliest convenience to avoid\n          account escalation or service interruption.\n        </p>\n\n        <p style=\"margin-top:10px; font-size:13px; color:#374151;\">\n          If payment has already been completed, kindly ignore this reminder.\n        </p>\n\n      </td>\n    </tr>\n\n    <!-- FOOTER -->\n    <tr>\n      <td style=\"padding:14px; background:#fef2f2; font-size:11px; color:#7f1d1d;\">\n        This is an automated reminder generated by\n        <strong>EDUVŒõULT OS‚Ñ¢</strong>.<br>\n        Please do not reply to this email.\n      </td>\n    </tr>\n\n  </table>\n\n</td>\n```\n\n  </tr>\n</table>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2528,
        2240
      ],
      "id": "69fd968b-b467-4178-b297-25d6b5e63e7a",
      "name": "Gmail_Send_SOFT_Reminder_Parent",
      "webhookId": "b3cb04d8-ade6-40f7-9098-63ab3bb0ecae",
      "retryOnFail": false,
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1872,
        2384
      ],
      "id": "895d0e42-97fe-4bf7-b84f-45258905a854",
      "name": "Split_Students_For_Email1"
    },
    {
      "parameters": {
        "fieldToSplitOut": "students",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        2320,
        2368
      ],
      "id": "80a7daf5-09f6-4063-bba3-38329a38b1c2",
      "name": "Split_Students_For_Email1.1"
    },
    {
      "parameters": {
        "fieldToSplitOut": "students",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        2320,
        2944
      ],
      "id": "897ef456-1f19-4f1f-9b59-8d6e6aa81730",
      "name": "Split_Students_For_Email2.1"
    },
    {
      "parameters": {
        "fieldToSplitOut": "students",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        2320,
        3504
      ],
      "id": "ac1a51ae-8042-4702-8d3f-251ff636c6a1",
      "name": "Split_Students_For_Email3.1"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1872,
        2960
      ],
      "id": "82d78a06-1249-4e16-99c8-ff6df2509f36",
      "name": "Split_Students_For_Email2"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1872,
        3520
      ],
      "id": "ca4a9100-ed2d-461d-83c2-3c6284944a11",
      "name": "Split_Students_For_Email3"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me1",
      "typeVersion": 1,
      "position": [
        2096,
        2400
      ],
      "id": "0af59f7e-972a-48cb-8e23-244160cb7494"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me3",
      "typeVersion": 1,
      "position": [
        2096,
        3536
      ],
      "id": "9b28eb1e-2409-4ea7-b659-bc85fcd18041"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "Replace Me2",
      "typeVersion": 1,
      "position": [
        2096,
        2976
      ],
      "id": "567e28d7-c123-43fd-8249-13b3d515cb7f"
    },
    {
      "parameters": {
        "jsCode": "const input = $input.all();\n\nconst validItems = [];\nconst invalidEmailStudents = [];\n\nfor (const item of input) {\n  const students = item.json.students || [];\n\n  const validStudents = [];\n  const invalidStudents = [];\n\n  for (const s of students) {\n    const parentOk = isValidEmail(s.Parent_Email);\n    const studentOk = isValidEmail(s.Student_Email);\n\n    if (parentOk || studentOk) {\n      validStudents.push(s);\n    } else {\n      invalidStudents.push(s);\n    }\n  }\n\n  // ‚úÖ SAME structure ‚Äî only students filtered\n  validItems.push({\n    json: {\n      ...item.json,\n      students: validStudents,\n    },\n  });\n\n  // ‚ùå invalid emails ‚Üí admin report\n  for (const bad of invalidStudents) {\n    invalidEmailStudents.push({\n      class: item.json.class,\n      month: item.json.month,\n      Galaxy_ID: bad.Galaxy_ID,\n      Full_Name: bad.Full_Name,\n      Parent_Email: bad.Parent_Email || '(empty)',\n      Student_Email: bad.Student_Email || '(empty)',\n    });\n  }\n}\n\n// helper\nfunction isValidEmail(email) {\n  if (!email) return false;\n  return /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email);\n}\n\n// SECOND OUTPUT = invalid emails for admin\nreturn [\n  ...validItems,\n  {\n    json: {\n      invalid_email_students: invalidEmailStudents,\n    },\n  },\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        976,
        2688
      ],
      "id": "75ee7689-c913-4d00-9e6a-fc443c40d9f3",
      "name": "Email_Safety_Filter",
      "disabled": true
    },
    {
      "parameters": {
        "sendTo": "ai.ml.nauman@gmail.com",
        "subject": "=Invalid / Missing Email IDs ‚Äì {{ $json.month }}",
        "emailType": "text",
        "message": "=Hello Admin,\n\nThe following students could not be emailed due to missing or invalid email IDs.\n\n--------------------------------\n{{ $json.invalid_email_students\n  .map(s =>\n    `‚Ä¢ ${s.Full_Name} (${s.Galaxy_ID})\n    Parent: ${s.Parent_Email}\n    Student: ${s.Student_Email}\n    Class: ${s.class}`\n  )\n  .join('\\n\\n')\n}}\n--------------------------------\n\nPlease update their contact details.\n\nEduVault System\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1376,
        2688
      ],
      "id": "d432cc79-ac2a-47c2-ad9c-c22474c7e419",
      "name": "Gmail_Send_Invalid_Email_Report_Admin",
      "webhookId": "e34a228a-9a0a-4da5-a376-8c2a277acd77",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      },
      "disabled": true
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// =============================\n//  Node 2: Clean + Validate\n// =============================\n\nconst f = $json;\n\n// 1. Required fields\nconst required = [\n  \"Full Name\",\n  \"Gender\",\n  \"Date of Birth\",\n  \"Class\",\n  \"Parent Type\",\n  \"Parent Name\",\n  \"Student Email\",\n  \"Parent Email\",\n  \"Primary Phone\",\n  \"Student CNIC\",\n  \"Parent CNIC\",\n  \"Address\",\n  \"Admission Fee\",\n  \"Monthly Fee\",\n  \"Scholarship %\"\n];\n\nfor (const r of required) {\n  if (!f[r] || f[r].toString().trim() === \"\") {\n    throw new Error(`Missing required field: ${r}`);\n  }\n}\n\n// 2. CNIC validation\nconst cnicRegex = /^\\d{13}$/;\n\nif (!cnicRegex.test(f[\"Student CNIC\"])) {\n  throw new Error(\"Invalid Student CNIC ‚Äî must be 13 digits\");\n}\n\nif (!cnicRegex.test(f[\"Parent CNIC\"])) {\n  throw new Error(\"Invalid Parent CNIC ‚Äî must be 13 digits\");\n}\n\n// 3. Class ‚Üí Class_Sheet\nconst classNumber = f[\"Class\"].toString().trim();\nconst classSheet = `Class_${classNumber.padStart(2, \"0\")}`;\n\n// 4. Admission Year\nconst admissionYear = new Date().getFullYear();\n\n// 5. Created At\nconst createdAt = new Date().toISOString();\n\n// 6. Final Clean Output\nreturn {\n  json: {\n    Full_Name: f[\"Full Name\"],\n    Gender: f[\"Gender\"],\n    DOB: f[\"Date of Birth\"],\n    Class: Number(f[\"Class\"]),\n    Class_Sheet: classSheet,\n    Parent_Type: f[\"Parent Type\"],\n    Parent_Name: f[\"Parent Name\"],\n    Student_Email: f[\"Student Email\"],\n    Parent_Email: f[\"Parent Email\"],\n    Phone_Primary: f[\"Primary Phone\"],\n    Phone_Secondary: f[\"Secondary Phone\"] || \"\",\n    Student_CNIC: f[\"Student CNIC\"],\n    Parent_CNIC: f[\"Parent CNIC\"],\n    Address: f[\"Address\"],\n    Admission_Fee: Number(f[\"Admission Fee\"]),\n    Monthly_Fee: Number(f[\"Monthly Fee\"]),\n    Scholarship_Percent: f[\"Scholarship %\"],\n    Admission_Year: admissionYear,\n    Status: \"Active\",\n    Created_At: createdAt\n  }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        384,
        560
      ],
      "id": "a11db064-9ef1-4036-b9fc-3ff4cf92a79a",
      "name": "Normalize_Galaxy_Intake_Payload"
    },
    {
      "parameters": {
        "url": "={{ \n`https://script.google.com/macros/s/AKfycbzI0zDpfY0JPYwBnhC0Qw-kQPIRKZTC4WuEZPXCCLQQGCTtjvb7TfDkRQWYVQKg8xM/exec?action=lastRow&class=${$json.Class_Sheet}&secret=LO737AIRLINESmnx`\n}}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        400,
        352
      ],
      "id": "90db1e87-2895-4cf8-8a0d-9c1cdd3cb942",
      "name": "Fetch_Galaxy_Identity_Sequence"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        704,
        480
      ],
      "id": "b4b09799-a0a7-4f7e-9a62-a7ac2a971c53",
      "name": "Assemble_Galaxy_Identity_Context"
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\nconst results = items.map(item => {\n  const d = item.json;\n\n  // Safeguard for missing data\n  const roll = d.lastRow !== undefined\n    ? d.lastRow.toString().padStart(2, \"0\")\n    : \"\";\n  const year = (d.Created_At || \"\").substring(2, 4);\n  const cls = d.Class !== undefined\n    ? d.Class.toString().padStart(2, \"0\")\n    : \"\";\n\n  const galaxyId = `S-AA${year}-${cls}-${roll}-mn`;\n\n  return {\n    json: {\n      ...d,\n      Galaxy_ID: galaxyId,\n      Roll_Number: roll,\n    }\n  };\n});\n\nreturn results;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        928,
        480
      ],
      "id": "0fa5d694-5313-4925-9bef-06b35d95adab",
      "name": "Forge_Galaxy_Identity"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1zMPWO7j_D0H87fkKbjLpQOxyrW3hbxCow1qT9rzH4UY",
          "mode": "list",
          "cachedResultName": "EDUVŒõULT_Persist_Galaxy_Core_Profile",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zMPWO7j_D0H87fkKbjLpQOxyrW3hbxCow1qT9rzH4UY/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "={{ $('Assemble_Galaxy_Identity_Context').item.json.Class_Sheet }}",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Galaxy_ID": "={{ $json.Galaxy_ID }}",
            "Roll_Number": "={{ $json.lastRow }}",
            "Full_Name": "={{ $json.Full_Name }}",
            "Gender": "={{ $json.Gender }}",
            "DOB": "={{ $json.DOB }}",
            "Class": "={{ $json.Class }}",
            "Created_At": "={{ $json.Created_At }}",
            "Status": "={{ $json.Status }}",
            "Admission_Year": "={{ $json.Admission_Year }}",
            "Scholarship_Percent": "={{ $json.Scholarship_Percent }}",
            "Monthly_Fee": "={{ $json.Monthly_Fee }}",
            "Admission_Fee": "={{ $json.Admission_Fee }}",
            "Address": "={{ $json.Address }}",
            "Phone_Secondary": "={{ $json.Phone_Secondary }}",
            "Phone_Primary": "={{ $json.Phone_Primary }}",
            "Parent_Email": "={{ $json.Parent_Email }}",
            "Student_Email": "={{ $json.Student_Email }}",
            "Parent_CNIC": "={{ $json.Parent_CNIC }}",
            "Parent_Name": "={{ $json.Parent_Name }}",
            "Parent_Type": "={{ $json.Parent_Type }}",
            "Student_CNIC": "={{ $json.Student_CNIC }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Galaxy_ID",
              "displayName": "Galaxy_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Roll_Number",
              "displayName": "Roll_Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Full_Name",
              "displayName": "Full_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Gender",
              "displayName": "Gender",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "DOB",
              "displayName": "DOB",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Class",
              "displayName": "Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Student_CNIC",
              "displayName": "Student_CNIC",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Parent_Type",
              "displayName": "Parent_Type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Parent_Name",
              "displayName": "Parent_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Parent_CNIC",
              "displayName": "Parent_CNIC",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Student_Email",
              "displayName": "Student_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Parent_Email",
              "displayName": "Parent_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Phone_Primary",
              "displayName": "Phone_Primary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Phone_Secondary",
              "displayName": "Phone_Secondary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Admission_Fee",
              "displayName": "Admission_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Monthly_Fee",
              "displayName": "Monthly_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Scholarship_Percent",
              "displayName": "Scholarship_Percent",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Admission_Year",
              "displayName": "Admission_Year",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Created_At",
              "displayName": "Created_At",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Left_campus_At",
              "displayName": "Left_campus_At",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Rejoined_after_break_At",
              "displayName": "Rejoined_after_break_At",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1152,
        480
      ],
      "id": "5011a840-a7dc-4f54-b853-5a99abb24091",
      "name": "Persist_Galaxy_Core_Profile",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MXqLnUIS1ffcXbNH",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json[\"Parent_Email\"] }}",
        "subject": "=EDUVŒõULT | Admission Record Successfully Committed",
        "message": "=  <p>\n    Congratulations! Your child‚Äôs admission has been successfully recorded in the\n    EDUVŒõULT Ecosystem.\n  </p>\n\n  <h3 style=\"margin-bottom: 5px;\">üéì Student Details</h3>\n  <table style=\"border-collapse: collapse;\">\n    <tr><td><strong>Galaxy ID:</strong></td><td>{{ $json[\"Galaxy_ID\"] }}</td></tr>\n    <tr><td><strong>Roll Number:</strong></td><td>{{ $json[\"Roll_Number\"] }}</td></tr>\n    <tr><td><strong>Name:</strong></td><td>{{ $json[\"Full_Name\"] }}</td></tr>\n    <tr><td><strong>Class:</strong></td><td>{{ $json[\"Class\"] }}</td></tr>\n    <tr><td><strong>Admission Year:</strong></td><td>{{ $json[\"Admission_Year\"] }}</td></tr>\n  </table>\n\n  <h3 style=\"margin-bottom: 5px;\">üìû Contact Details</h3>\n  <table style=\"border-collapse: collapse;\">\n    <tr><td><strong>Parent Name:</strong></td><td>{{ $json[\"Parent_Name\"] }}</td></tr>\n    <tr><td><strong>Phone:</strong></td><td>{{ $json[\"Phone_Primary\"] }}</td></tr>\n    <tr><td><strong>Parent Email:</strong></td><td>{{ $json[\"Parent_Email\"] }}</td></tr>\n  </table>\n\n  <h3 style=\"margin-bottom: 5px;\">üí∞ Fee Details</h3>\n  <table style=\"border-collapse: collapse;\">\n    <tr><td><strong>Admission Fee:</strong></td><td>{{ $json[\"Admission_Fee\"] }}</td></tr>\n    <tr><td><strong>Monthly Fee:</strong></td><td>{{ $json[\"Monthly_Fee\"] }}</td></tr>\n    <tr><td><strong>Scholarship:</strong></td><td>{{ $json[\"Scholarship_Percent\"] }}%</td></tr>\n  </table>\n\n  <p>\n    Your child is now officially part of the EDUVŒõULT Ecosystem.  \n    If you have any questions, feel free to reply to this email.\n  </p>\n\n  <p>Regards,<br><strong>EDUVŒõULT Admissions Team</strong></p>\n</div>\n",
        "options": {}
      },
      "id": "271729c8-de35-4a56-bc30-c8a2e1dd5ded",
      "name": "Dispatch_Galaxy_Notice_Guardian",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1472,
        64
      ],
      "webhookId": "94a8a7d9-db86-4cbe-a215-d083cac28a72",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.Student_Email }}",
        "subject": "=EDUVŒõULT | Student Admission Successfully Registered",
        "message": "=  <p>\n    Congratulations! Your admission has been successfully recorded in the\n    EDUVŒõULT Ecosystem.\n  </p>\n\n  <h3 style=\"margin-bottom: 5px;\">üéì Student Details</h3>\n  <table style=\"border-collapse: collapse;\">\n    <tr><td><strong>Galaxy ID:</strong></td><td>{{ $json[\"Galaxy_ID\"] }}</td></tr>\n    <tr><td><strong>Roll Number:</strong></td><td>{{ $json[\"Roll_Number\"] }}</td></tr>\n    <tr><td><strong>Name:</strong></td><td>{{ $json[\"Full_Name\"] }}</td></tr>\n    <tr><td><strong>Class:</strong></td><td>{{ $json[\"Class\"] }}</td></tr>\n    <tr><td><strong>Admission Year:</strong></td><td>{{ $json[\"Admission_Year\"] }}</td></tr>\n  </table>\n\n  <h3 style=\"margin-bottom: 5px;\">üí¨ Message For You</h3>\n  <p>\n    Welcome to EDUVŒõULT! We are excited to have you on board.  \n    Your journey of learning, growth, and achievement begins today.\n  </p>\n\n  <blockquote style=\"border-left: 3px solid #ddd; padding-left: 10px; margin: 10px 0;\">\n    <em>\n      \"Every new day brings a new chance ‚Äî believe in yourself, stay focused,\n      keep learning, and success will always follow you.\"\n    </em>\n  </blockquote>\n\n  <p>\n    If you have any questions, feel free to reply to this email.\n  </p>\n\n  <p>Regards,<br><strong>EDUVŒõULT Admissions Team</strong></p>\n</div>\n\n\n  \n",
        "options": {}
      },
      "id": "4d91533b-f3bb-476c-aada-1bf034e0aeb3",
      "name": "Dispatch_Galaxy_Notice_Primary",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1472,
        480
      ],
      "webhookId": "f9cb5f53-3009-4029-9a0f-a3882fdd4d6d",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "=ai.ml.nauman@gmail.com",
        "subject": "=EDUVŒõULT | New Student Admission Recorded\n",
        "message": "=  <p>\n    A new student admission has been successfully added to the EDUVŒõULT Ecosystem.\n    Below are the complete admission details.\n  </p>\n\n  <h3 style=\"margin-bottom: 5px;\">üéì Student Details</h3>\n  <table style=\"border-collapse: collapse;\">\n    <tr><td><strong>Galaxy ID:</strong></td><td>{{ $json[\"Galaxy_ID\"] }}</td></tr>\n    <tr><td><strong>Roll Number:</strong></td><td>{{ $json[\"Roll_Number\"] }}</td></tr>\n    <tr><td><strong>Name:</strong></td><td>{{ $json[\"Full_Name\"] }}</td></tr>\n    <tr><td><strong>Class:</strong></td><td>{{ $json[\"Class\"] }}</td></tr>\n    <tr><td><strong>Admission Year:</strong></td><td>{{ $json[\"Admission_Year\"] }}</td></tr>\n  </table>\n\n  <h3 style=\"margin-bottom: 5px;\">üë®‚Äçüë©‚Äçüëß Parent Details</h3>\n  <table style=\"border-collapse: collapse;\">\n    <tr><td><strong>Parent Name:</strong></td><td>{{ $json[\"Parent_Name\"] }}</td></tr>\n    <tr><td><strong>Parent Type:</strong></td><td>{{ $json[\"Parent_Type\"] }}</td></tr>\n    <tr><td><strong>Phone:</strong></td><td>{{ $json[\"Phone_Primary\"] }}</td></tr>\n    <tr><td><strong>Parent Email:</strong></td><td>{{ $json[\"Parent_Email\"] }}</td></tr>\n  </table>\n\n  <h3 style=\"margin-bottom: 5px;\">üí∞ Fee Details</h3>\n  <table style=\"border-collapse: collapse;\">\n    <tr><td><strong>Admission Fee:</strong></td><td>{{ $json[\"Admission_Fee\"] }}</td></tr>\n    <tr><td><strong>Monthly Fee:</strong></td><td>{{ $json[\"Monthly_Fee\"] }}</td></tr>\n    <tr><td><strong>Scholarship:</strong></td><td>{{ $json[\"Scholarship_Percent\"] }}%</td></tr>\n  </table>\n\n  <h3 style=\"margin-bottom: 5px;\">üïí Submission Info</h3>\n  <table style=\"border-collapse: collapse;\">\n    <tr><td><strong>Submitted At:</strong></td><td>{{ $json[\"Created_At\"] }}</td></tr>\n  </table>\n\n  <p>\n    Please review the student's record in the Google Sheet if any action is required.\n  </p>\n\n  <p>Regards,<br><strong>EDUVŒõULT Admissions Bot</strong></p>\n</div>\n",
        "options": {}
      },
      "id": "d4eaccd6-b51a-4f02-9942-a60db3e777b7",
      "name": "Dispatch_Galaxy_Notice_Administration",
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1472,
        896
      ],
      "webhookId": "aca747cf-28fb-48f2-b479-014b4fc94ef2",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const data = $json;\n\n// 1Ô∏è‚É£ Validate mandatory fields\nif (!data.class) {\n  throw new Error(\"Class is required\");\n}\n\nconst P_raw = data[\"‚úî ‚Üí P\"] || \"\";\nconst A_raw = data[\"‚úñ ‚Üí A\"] || \"\";\nconst L_raw = data[\"‚óê ‚Üí L\"] || \"\";\n\nif (!P_raw && !A_raw && !L_raw) {\n  throw new Error(\"At least one attendance command (P/A/L) is required\");\n}\n\n// 2Ô∏è‚É£ Date context (ONLY for column naming)\nconst submittedAt = new Date(data.submittedAt);\nconst year = submittedAt.getFullYear();\nconst monthIndex = submittedAt.getMonth();\nconst day = submittedAt.getDate();\n\nconst MONTHS = [\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];\nconst monthShort = MONTHS[monthIndex];\nconst yearShort = year.toString().slice(-2);\n\n// Attendance column name\nconst attendance_column = `A_${monthShort}${yearShort}_${day.toString().padStart(2,\"0\")}`;\n\n// Helpers\nconst pad2 = (n) => n.toString().padStart(2, \"0\");\nconst classNum = data.class.replace(\"Class_\", \"\");\n\n// Parse rolls\nconst parse = (str) =>\n  str.split(\",\").map(v => v.trim()).filter(Boolean);\n\n// Build updates\nconst updates = [];\n\nparse(P_raw).forEach(r => {\n  updates.push({\n    galaxy_id: `S-AA25-${classNum}-${pad2(r)}-mn`,\n    value: \"‚úî\"\n  });\n});\n\nparse(A_raw).forEach(r => {\n  updates.push({\n    galaxy_id: `S-AA25-${classNum}-${pad2(r)}-mn`,\n    value: \"‚úñ\"\n  });\n});\n\nparse(L_raw).forEach(r => {\n  updates.push({\n    galaxy_id: `S-AA25-${classNum}-${pad2(r)}-mn`,\n    value: \"‚óê\"\n  });\n});\n\n// 3Ô∏è‚É£ FINAL OUTPUT (NO ROLL NUMBERS)\nreturn {\n  class: data.class,\n  attendance_column,\n  updates,\n  meta: {\n    year,\n    month: monthShort,\n    day: day.toString().padStart(2,\"0\"),\n    submittedAt: data.submittedAt\n  }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2144,
        4416
      ],
      "id": "0a05edf4-65cb-4fa0-8167-f1decd19a7cb",
      "name": "CODE_Attendance_Command_Resolver"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months",
              "triggerAtHour": 1,
              "triggerAtMinute": 5
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        64,
        4272
      ],
      "id": "4807b4da-3204-4cc9-85ad-fb71eca447fe",
      "name": "CRON_Monthly_Attendance_Init"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbyqBSpJgWvfB3Jkc0mArYrY4j7BXZvyYcQ9h38XAfzljjt25yRjGQfQ9y452SpYn0Lqvw/exec",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"action\": \"addColumns\",\n  \"secret\": \"EV-Attendance-API-2026\",\n  \"sheet\": \"{{ $json.sheet }}\",\n  \"columns\": {{ JSON.stringify($json.missing_columns) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1616,
        4208
      ],
      "id": "454e6e18-3fd6-465c-9bdc-a11a96625652",
      "name": "HTTP ‚ñ∏ Attendance Column Architect"
    },
    {
      "parameters": {
        "url": "https://script.google.com/macros/s/AKfycbx9ps6E5M94ORFMbi11kUuajp7Us7kE9htt5-XVdcQ6YJCLwMJT6jd9Eu4TiUAWrFbLcA/exec",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "action",
              "value": "getHeaders"
            },
            {
              "name": "sheet",
              "value": "={{ $json.class }}"
            },
            {
              "name": "secret",
              "value": "EV-Attendance-API-2026"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1136,
        4208
      ],
      "id": "8b666c1b-3995-4db4-bdc5-887443da5531",
      "name": "HTTP ‚ñ∏ Attendance Header Sentinel"
    },
    {
      "parameters": {
        "jsCode": "// Class list 01 to 12\nconst classes = [];\n\nfor (let i = 1; i <= 12; i++) {\n  classes.push({\n    class: `Class_${i.toString().padStart(2, \"0\")}`\n  });\n}\n\nreturn classes;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        592,
        4352
      ],
      "id": "d76ef05e-d3a1-40ef-949d-e1d26081e7bd",
      "name": "CLASS_ORCHESTRATOR_MATRIX"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// 1Ô∏è‚É£ Get expected columns from the generator node (single source of truth)\nconst expected =\n  $items(\"ATTENDANCE_SCHEMA_COMPOSER\")[0]?.json?.expected_columns || [];\n\n// 2Ô∏è‚É£ Get existing headers from current item\nconst headers = Array.isArray($json.headers)\n  ? $json.headers\n  : [];\n\n// 3Ô∏è‚É£ Compare\nconst missing = expected.filter(col => !headers.includes(col));\n\n// 4Ô∏è‚É£ Return decision\nreturn {\n  sheet: $json.sheet,\n  missing_columns: missing,\n  should_insert: missing.length > 0\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1376,
        4208
      ],
      "id": "619ea117-c961-420d-99f2-b42cb95243d2",
      "name": "ATTENDANCE_SCHEMA_DIFFERENCE_ENGINE"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        896,
        4208
      ],
      "id": "d71b67c6-c695-4c32-8fe6-a85e7dd49690",
      "name": "ACADEMIC_SCHEMA_FUSION_CORE"
    },
    {
      "parameters": {
        "jsCode": "const now = new Date();\n\nconst year = now.getFullYear();\nconst monthIndex = now.getMonth(); // 0‚Äì11\nconst MONTHS = [\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];\n\nconst monthShort = MONTHS[monthIndex];\nconst yearShort = year.toString().slice(-2);\n\n// days in month\nconst daysInMonth = new Date(year, monthIndex + 1, 0).getDate();\n\nreturn {\n  year,\n  yearShort,\n  monthIndex,\n  monthShort,\n  daysInMonth\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        304,
        4528
      ],
      "id": "0e0c31e7-65cd-4600-9b92-81cca4982c79",
      "name": "TEMPORAL_ATTENDANCE_CONTEXT_ENGINE"
    },
    {
      "parameters": {
        "jsCode": "const {\n  monthShort,\n  yearShort,\n  daysInMonth\n} = $json;\n\nconst columns = [];\n\n// Daily columns\nfor (let d = 1; d <= daysInMonth; d++) {\n  columns.push(`A_${monthShort}${yearShort}_${d.toString().padStart(2,\"0\")}`);\n}\n\n// Summary columns\n[\"T\",\"P\",\"A\",\"L\",\"H\"].forEach(suffix => {\n  columns.push(`A_${monthShort}${yearShort}_${suffix}`);\n});\n\nreturn {\n  expected_columns: columns\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        576,
        4528
      ],
      "id": "dfa5a1d3-ae11-4e0e-9e82-9cbc915461d7",
      "name": "ATTENDANCE_SCHEMA_COMPOSER"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbzm4eG1yH3hbqDWC9aov-CXzpzYwAnQpTZ1M5Rc-YtaNqBKUnVg04fKVRjHFPaieeBBjg/exec",
        "sendBody": true,
        "contentType": "raw",
        "body": "={ \n\"action\": \"resolveRows\",   \n\"secret\": \"EV-Attendance-API-2026\",   \n\"class\": \"{{ $json.class }}\",   \n\"galaxy_ids\": {{ JSON.stringify($json.updates.map(u => u.galaxy_id)) }} \n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2144,
        4208
      ],
      "id": "e987dba7-b99c-4c02-b163-80928ccdaff6",
      "name": "HTTP ‚ñ∏ Galaxy Row Sentinel"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbwjra3gfAjwfcxxjsodSp7DxavaaeNX2VLsOHQ0RJE1eObJY1Mb2a9JdMd1c11B_PfAhw/exec",
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={{ JSON.stringify({\n  action: \"batchAttendanceWrite\",\n  secret: \"EV-Attendance-API-2026\",\n  class: $json.class,\n  attendance_column: $json.attendance_column,\n  writes: $json.writes\n}) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2704,
        4192
      ],
      "id": "417b552c-ed33-4629-b56e-8184ef78a2c0",
      "name": "‚Üí HTTP ‚ñ∏ Attendance Batch Writer"
    },
    {
      "parameters": {
        "jsCode": "const input = $json;\n\n// Safety\nif (!input.rows || !input.updates) {\n  throw new Error(\"rows or updates missing\");\n}\n\nconst writes = [];\n\nfor (const u of input.updates) {\n  const row = input.rows[u.galaxy_id];\n\n  // Ignore null / missing rows\n  if (!row) continue;\n\n  writes.push({\n    galaxy_id: u.galaxy_id,\n    row,\n    column: input.attendance_column,\n    value: u.value\n  });\n}\n\nreturn [{\n  action: \"batchAttendanceWrite\",\n  class: input.class,\n  attendance_column: input.attendance_column,\n  writes\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2704,
        4384
      ],
      "id": "c3640179-06b1-4d06-9c55-34c9d0ecf9e4",
      "name": "CODE ‚ñ∏ Attendance Batch Builder"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2432,
        4304
      ],
      "id": "23638f79-a0f6-4ddc-a6c4-e7fdd98fe9ae",
      "name": "MERGE ‚ñ∏ Attendance Context Unifier"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "d72153e1-de9b-4eaf-9f94-fe44a37a2da1",
              "leftValue": "={{$json.ok}}",
              "rightValue": "=",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3008,
        4352
      ],
      "id": "7149c8cf-87bb-4c87-b93e-9da52a57eaf1",
      "name": "IF ‚ñ∏ Attendance Write Status"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        3264,
        4128
      ],
      "id": "fcac6a1b-530f-4925-ba40-e75b4ff80d81",
      "name": "MERGE ‚ñ∏ Success Attendance Context"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        3264,
        4560
      ],
      "id": "0e1bdd0e-a7e1-4ee0-bdce-97ceb66cef91",
      "name": "MERGE ‚ñ∏ Failed Attendance Context"
    },
    {
      "parameters": {
        "sendTo": "kingofpak111@gmail.com",
        "subject": "=Attendance Recorded Successfully | {{ $json.class }} | {{ $json.attendance_column }}",
        "message": "=Dear **Faculty Member**,  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; border-collapse:collapse;\">   <tr>     <td style=\"padding:16px; background:#0f172a; color:#ffffff;\">       <strong style=\"font-size:18px;\">EDUVAULT Attendance System</strong><br>       <span style=\"font-size:12px; color:#cbd5e1;\">Automated Academic Operations</span>     </td>   </tr>    <tr>     <td style=\"padding:18px; background:#ffffff;\">       <p style=\"font-size:14px; color:#111827;\">         This is to formally confirm that the attendance for the following class has been         <strong style=\"color:#065f46;\">successfully recorded</strong> in the system.       </p>  ```   <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\" style=\"margin:12px 0; font-size:13px;\">     <tr>       <td width=\"180\"><strong>Class</strong></td>       <td>{{ $json.class }}</td>     </tr>     <tr>       <td><strong>Attendance Date</strong></td>       <td>{{ $json.attendance_column }}</td>     </tr>     <tr>       <td><strong>Total Records Written</strong></td>       <td>{{ $json.written }}</td>     </tr>   </table>    <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:16px 0;\">    <p style=\"font-size:14px; font-weight:bold; margin-bottom:8px;\">     Attendance Snapshot   </p>    <table width=\"100%\" cellpadding=\"8\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; font-size:13px;\">     <tr style=\"background:#f1f5f9;\">       <th align=\"left\">Galaxy ID</th>       <th align=\"left\">Row</th>       <th align=\"left\">Status</th>     </tr>      {{ $json.writes.map(w => `     <tr>       <td>${w.galaxy_id}</td>       <td>${w.row}</td>       <td><strong>${w.value}</strong></td>     </tr>     `).join('') }}   </table>    <p style=\"margin-top:16px; font-size:13px; color:#374151;\">     No further action is required at this time. This record is now locked and reflected     in monthly summaries and dashboards.   </p> </td> ```    </tr>    <tr>     <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">       This is an automated confirmation generated by EDUVAULT.         Please do not reply to this email.     </td>   </tr> </table>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        3504,
        4208
      ],
      "id": "e2cb5dad-76fb-41f7-930f-91ed7132a413",
      "name": "Attendance Recorded Successfully",
      "webhookId": "de9d3760-5bd7-44e8-bf76-222f090f9e0f",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "kingofpak111@gmail.com",
        "subject": "=Attendance Submission Failed | {{ $json.class }} | Action Required",
        "message": "=Dear **Faculty Member**,  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; border-collapse:collapse;\">   <tr>     <td style=\"padding:16px; background:#7f1d1d; color:#ffffff;\">       <strong style=\"font-size:18px;\">EDUVAULT Attendance Alert</strong><br>       <span style=\"font-size:12px; color:#fecaca;\">System Validation Notice</span>     </td>   </tr>    <tr>     <td style=\"padding:18px; background:#ffffff;\">       <p style=\"font-size:14px; color:#111827;\">         We regret to inform you that the attendance submission attempt for the class below         <strong style=\"color:#b91c1c;\">could not be completed</strong>.       </p>  ```   <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\" style=\"margin:12px 0; font-size:13px;\">     <tr>       <td width=\"180\"><strong>Class</strong></td>       <td>{{ $json.class }}</td>     </tr>     <tr>       <td><strong>Attendance Date</strong></td>       <td>{{ $json.attendance_column }}</td>     </tr>   </table>    <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:16px 0;\">    <p style=\"font-size:14px; font-weight:bold; margin-bottom:8px;\">     Affected Records   </p>    <table width=\"100%\" cellpadding=\"8\" cellspacing=\"0\" border=\"1\" style=\"border-collapse:collapse; font-size:13px;\">     <tr style=\"background:#fee2e2;\">       <th align=\"left\">Galaxy ID</th>       <th align=\"left\">Row</th>       <th align=\"left\">Attempted Value</th>     </tr>      {{ $json.writes.map(w => `     <tr>       <td>${w.galaxy_id}</td>       <td>${w.row}</td>       <td><strong>${w.value}</strong></td>     </tr>     `).join('') }}   </table>    <p style=\"margin-top:16px; font-size:13px; color:#374151;\">     Please re-submit the attendance after verifying the entries.       If the issue persists, contact the academic administration team.   </p> </td> ```    </tr>    <tr>     <td style=\"padding:14px; background:#fef2f2; font-size:11px; color:#7f1d1d;\">       This notification was generated automatically by EDUVAULT.         Data integrity has been preserved ‚Äî no partial writes occurred.     </td>   </tr> </table>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        3504,
        4432
      ],
      "id": "43b5dbf1-3334-4d79-aa88-1b4ad7f4e174",
      "name": "Attendance Submission Failed",
      "webhookId": "846f8050-16e4-43b6-824d-64d4531752a2",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 13,
              "triggerAtMinute": 5
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        3744,
        4320
      ],
      "id": "877470a7-4c04-4b62-9ec5-a3add48e2d9e",
      "name": "CRON ‚ñ∏ Daily Holiday Scanner (11AM)"
    },
    {
      "parameters": {
        "jsCode": "// Date at cron execution\nconst now = new Date();\n\nconst months = [\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];\nconst month = months[now.getMonth()];\nconst year = now.getFullYear().toString().slice(-2);\nconst day = now.getDate();\n\nconst attendance_column = `A_${month}${year}_${day}`;\n\nreturn [{\n  action: \"autoHolidayFill\",\n  attendance_column\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        4000,
        4320
      ],
      "id": "f01f43de-2ceb-4bbe-b496-c2d24c4a1bd0",
      "name": "CODE ‚ñ∏ Holiday Column Resolver"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbyA_flxO0qM9RFiaBbgsrRPqgqHH__0mwQ7Lf0vWFF0uMUa8hbrFzi5ZQYRDA_xgMmrRg/exec",
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={{ JSON.stringify({\n  action: $json.action,\n  attendance_column: $json.attendance_column,\n  secret: \"EV-Attendance-API-2026\"\n}) }}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        4240,
        4320
      ],
      "id": "903a3276-2384-4b25-805b-bb5d18b7c7b2",
      "name": "HTTP ‚ñ∏ Holiday Auto Writer"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "9c85b92e-3380-4cab-b3b1-bde3f03cf471",
              "leftValue": "={{$json.holidaysFilled}}",
              "rightValue": 0,
              "operator": {
                "type": "number",
                "operation": "gt"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        4496,
        4320
      ],
      "id": "c40ea631-d6ad-4074-870e-192c7547e39b",
      "name": "IF ‚ñ∏ Holiday Applied?"
    },
    {
      "parameters": {
        "sendTo": "kingofpak111@gmail.com",
        "subject": "=Auto Holiday Applied | {{ $json.attendance_column }} | EDUVAULT Attendance System Report",
        "message": "=Dear **Administrator**,\n\n<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; border-collapse:collapse;\">\n\n  <!-- HEADER -->\n\n  <tr>\n    <td style=\"padding:16px; background:#0f172a; color:#ffffff;\">\n      <strong style=\"font-size:18px;\">EDUVAULT Attendance System</strong><br>\n      <span style=\"font-size:12px; color:#cbd5e1;\">Automated Academic Operations</span>\n    </td>\n  </tr>\n\n  <!-- BODY -->\n\n  <tr>\n    <td style=\"padding:18px; background:#ffffff;\">\n      <p style=\"font-size:14px; color:#111827;\">\n        This is to formally confirm that the system has\n        <strong style=\"color:#7c2d12;\">automatically applied a Holiday (üÖ∑)</strong>\n        for missing attendance entries where no manual submission was detected.\n      </p>\n\n```\n  <!-- SUMMARY TABLE -->\n  <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\" style=\"margin:12px 0; font-size:13px;\">\n    <tr>\n      <td width=\"220\"><strong>Attendance Date</strong></td>\n      <td>{{ $json.attendance_column }}</td>\n    </tr>\n    <tr>\n      <td><strong>Total Classes Processed</strong></td>\n      <td>{{ $json.classesProcessed }}</td>\n    </tr>\n    <tr>\n      <td><strong>Holiday Records Applied</strong></td>\n      <td>{{ $json.holidaysFilled }}</td>\n    </tr>\n  </table>\n\n  <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:16px 0;\">\n\n  <!-- SNAPSHOT -->\n  <p style=\"font-size:14px; font-weight:bold; margin-bottom:8px;\">\n    Auto Holiday Snapshot\n  </p>\n\n  <table width=\"100%\" cellpadding=\"8\" cellspacing=\"0\" border=\"1\"\n    style=\"border-collapse:collapse; font-size:13px;\">\n    <tr style=\"background:#f1f5f9;\">\n      <th align=\"left\">Class</th>\n      <th align=\"left\">Galaxy ID</th>\n      <th align=\"left\">Row</th>\n      <th align=\"left\">Status</th>\n    </tr>\n\n    {{ $json.filledRecords.map(r => `\n    <tr>\n      <td>${r.class}</td>\n      <td>${r.galaxy_id || '-'}</td>\n      <td>${r.row}</td>\n      <td><strong>${r.value}</strong></td>\n    </tr>\n    `).join('') }}\n\n  </table>\n\n  <p style=\"margin-top:16px; font-size:13px; color:#374151;\">\n    Existing attendance values were <strong>preserved</strong>. Holiday markers were applied\n    <strong>only to empty records</strong> in accordance with attendance governance policy.\n  </p>\n</td>\n```\n\n  </tr>\n\n  <!-- FOOTER -->\n\n  <tr>\n    <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">\n      This is an automated system notification generated by EDUVAULT.\n      Please do not reply to this email.\n    </td>\n  </tr>\n\n</table>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        4768,
        4304
      ],
      "id": "9eed0eb1-0008-44e8-8bdd-9dfc39c8483c",
      "name": "EMAIL ‚ñ∏ Admin Holiday Report",
      "webhookId": "cca87ede-afde-4a5a-baa9-e75c4d7b97c8",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "content": "Monthly Aggregation Engine",
        "height": 1008,
        "width": 1360,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        2192,
        4944
      ],
      "typeVersion": 1,
      "id": "1b9f4e38-02b2-4318-aabc-0a206ee85c3a",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "28a3fa45-b634-4b80-8ca4-c28e51de9daf",
              "leftValue": "={{ $json.ok }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2960,
        5328
      ],
      "id": "e7a5dd15-175f-4401-a5d2-713a9f777d5b",
      "name": "IF ‚ñ∏ Aggregation Success Check"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbxnhwzx2yo5lvYCYtLMXIBuLbprLy6VPZ8Fzv68Xeq0WYpj01PqGMQxIbvrNSd02y4D/exec",
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={\n  \"action\": \"monthlyAggregation\",\n  \"secret\": \"EV-Attendance-API-2026\",\n  \"monthCode\": \"{{ $json.monthCode }}\",\n  \"attendancePrefix\": \"{{ $json.attendancePrefix }}\",\n  \"year\": \"{{ $json.year }}\"\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        2720,
        5328
      ],
      "id": "3ec8da4e-906b-430c-ab2e-25824d816743",
      "name": "HTTP ‚ñ∏ Monthly Aggregation Engine"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months",
              "triggerAtHour": 2,
              "triggerAtMinute": 20
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        1792,
        5056
      ],
      "id": "0c2ab514-4e4c-4be8-8feb-8aaa408e4fe1",
      "name": "CRON ‚ñ∏ Monthly Aggregation Trigger"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbzos76jk0jgzAzE7YS_ExsY2RgwWnUT7eGUK3koypk1TU-02qVnPRRB3a9LGOWO88cYOw/exec",
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={\n  \"action\": \"fetchMonthlyStudentData\",\n  \"secret\": \"EV-Attendance-API-2026\",\n  \"action\": \"{{ $json.action }}\",\n  \"monthCode\": \"{{ $json.monthCode }}\"\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        480,
        5360
      ],
      "id": "9fcd2d84-74bf-4559-b762-061c89abf4ce",
      "name": "HTTP ‚ñ∏ Fetch Monthly Student Data"
    },
    {
      "parameters": {
        "jsCode": "// Source timestamp from CRON trigger (already merged)\nconst ts = new Date($json.timestamp);\n\n// Auto-detect\nconst yearFull = ts.getFullYear();          // 2025\nconst yearShort = String(yearFull).slice(-2); // 25\n\nconst monthNames = [\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];\nconst monthIndex = ts.getMonth();           // 0-11\nconst monthShort = monthNames[monthIndex]; // Dec\nconst monthName = ts.toLocaleString(\"en-US\", { month: \"long\" }); // December\n\n// Final computed codes\nconst monthCode = `${monthShort}${yearShort}`; // Dec25\nconst attendancePrefix = `A_${monthCode}_`;    // A_Dec25_\n\nreturn [\n  {\n    json: {\n      action: \"fetchMonthlyStudentData\",\n      monthCode,\n      monthName,\n      year: yearFull,\n      attendancePrefix,\n      summary: {\n        classesProcessed: $json.classesProcessed,\n        studentsProcessed: $json.studentsProcessed,\n        executedAt: $json.timestamp,\n        timezone: $json.Timezone\n      }\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2464,
        5328
      ],
      "id": "d3c8fb38-71ee-47f8-a70d-3e1523311a7a",
      "name": "Code in JavaScript"
    },
    {
      "parameters": {
        "jsCode": "const rows = $json.rows || [];\nconst month = $json.month;\n\n/* =========================\n   ADMIN AGGREGATION\n========================= */\n\nconst adminMap = {};\n\nfor (const r of rows) {\n  if (!adminMap[r.class]) {\n    adminMap[r.class] = {\n      class: r.class,\n      T: 0,\n      P: 0,\n      A: 0,\n      L: 0,\n      H: 0\n    };\n  }\n\n  adminMap[r.class].T += Number(r.A_T || 0);\n  adminMap[r.class].P += Number(r.A_P || 0);\n  adminMap[r.class].A += Number(r.A_A || 0);\n  adminMap[r.class].L += Number(r.A_L || 0);\n  adminMap[r.class].H += Number(r.A_H || 0);\n}\n\n/* =========================\n   STUDENT / PARENT ITEMS\n========================= */\n\nconst studentItems = rows\n  .filter(r => r.student_email)\n  .map(r => ({\n    pipeline: \"STUDENT_MAIL\",\n    to: r.student_email,\n    month,\n    class: r.class,\n    galaxy_id: r.galaxy_id,\n    totals: {\n      T: r.A_T,\n      P: r.A_P,\n      A: r.A_A,\n      L: r.A_L,\n      H: r.A_H\n    }\n  }));\n\nconst parentItems = rows\n  .filter(r => r.parent_email)\n  .map(r => ({\n    pipeline: \"PARENT_MAIL\",\n    to: r.parent_email,\n    month,\n    class: r.class,\n    galaxy_id: r.galaxy_id,\n    totals: {\n      T: r.A_T,\n      P: r.A_P,\n      A: r.A_A,\n      L: r.A_L,\n      H: r.A_H\n    }\n  }));\n\n/* =========================\n   FINAL RETURN (CRITICAL)\n========================= */\n\nreturn [\n  {\n    pipeline: \"ADMIN_ANALYSIS\",\n    month,\n    classes: Object.values(adminMap) // üëà COMPLETE CLASS SUMMARY\n  },\n  ...studentItems,\n  ...parentItems\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        704,
        5360
      ],
      "id": "5522d42a-dbbc-4d4b-a89e-4aaea2ceb07a",
      "name": "CODE ‚Üí Pipeline Router"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.pipeline }}",
                    "rightValue": "ADMIN_ANALYSIS",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "9589826e-c819-4944-8143-3b0f0fa55b34"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "d7f99eea-867e-4cf9-b82f-49ee755330c1",
                    "leftValue": "={{ $json.pipeline }}",
                    "rightValue": "STUDENT_MAIL",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "0bf8b7da-a904-479f-9417-300619b39c2b",
                    "leftValue": "={{ $json.pipeline }}",
                    "rightValue": "PARENT_MAIL",
                    "operator": {
                      "type": "string",
                      "operation": "equals",
                      "name": "filter.operator.equals"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        912,
        5344
      ],
      "id": "f682d20b-56e0-43fb-8c7d-b9f77cef4ccf",
      "name": "SWITCH ‚Üí Pipeline Router"
    },
    {
      "parameters": {
        "jsCode": "const now = new Date();\n\n// Month short name (Dec)\nconst month = now.toLocaleString('en-US', { month: 'short' });\n\n// Year last 2 digits (25)\nconst year = String(now.getFullYear()).slice(-2);\n\n// Final monthCode ‚Üí Dec25\nconst monthCode = `${month}${year}`;\n\nreturn [\n  {\n    action: \"fetchMonthlyRawAttendance\",\n    monthCode\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        272,
        5360
      ],
      "id": "ad17c4d8-7a6d-41a3-8fd5-9a597fd998f6",
      "name": "Code in JavaScript1"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months",
              "triggerAtHour": 9,
              "triggerAtMinute": 20
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        96,
        5360
      ],
      "id": "562c7c8d-9071-4351-a139-f86efa0f24f8",
      "name": "Schedule Trigger + Month Config Code Node"
    },
    {
      "parameters": {
        "jsCode": "const input = $json;\nconst classes = input.classes || [];\n\nlet eduvaultTotals = { T: 0, P: 0, A: 0, L: 0, H: 0 };\nlet eduvaultEffectivePresent = 0;\n\nconst classReports = classes.map(c => {\n  const T = c.T || 0;\n  const P = c.P || 0;\n  const A = c.A || 0;\n  const L = c.L || 0;\n  const H = c.H || 0;\n\n  eduvaultTotals.T += T;\n  eduvaultTotals.P += P;\n  eduvaultTotals.A += A;\n  eduvaultTotals.L += L;\n  eduvaultTotals.H += H;\n\n  // ‚úÖ EDUVŒõULT ATTENDANCE LOGIC\n  const effectivePresent = P + H + (L * 0.5);\n  eduvaultEffectivePresent += effectivePresent;\n\n  const attendancePercent = T > 0\n    ? Math.round((effectivePresent / T) * 100)\n    : 0;\n\n  return {\n    class: c.class,\n    totals: { T, P, A, L, H },\n    effectivePresent,\n    attendancePercent\n  };\n});\n\n/* ===== EDUVŒõULT ECOSYSTEM SUMMARY ===== */\nconst eduvaultAttendancePercent =\n  eduvaultTotals.T > 0\n    ? Math.round((eduvaultEffectivePresent / eduvaultTotals.T) * 100)\n    : 0;\n\nreturn [{\n  pipeline: \"ADMIN_ANALYSIS_READY\",\n  system: \"EDUVŒõULT ECOSYSTEM\",\n  month: input.month,\n  eduvaultSummary: {\n    totals: eduvaultTotals,\n    effectivePresent: eduvaultEffectivePresent,\n    attendancePercent: eduvaultAttendancePercent\n  },\n  classes: classReports\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1216,
        5056
      ],
      "id": "1c4bd893-a936-4e4a-9891-bd62ea6f32a0",
      "name": "Presence Fidelity Score (PFS)"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const email = $json.to;\n\n// agar email missing ho ‚Üí item drop\nif (!email || email.trim() === '') {\n  return null;\n}\n\nconst T = Number($json.totals?.T || 0);\nconst P = Number($json.totals?.P || 0);\nconst H = Number($json.totals?.H || 0);\nconst L = Number($json.totals?.L || 0);\nconst A = Number($json.totals?.A || 0);\n\nlet effectivePresent = 0;\nlet attendancePercent = 0;\n\nif (T > 0) {\n  effectivePresent = P + H + (L * 0.5);\n  attendancePercent = Math.round((effectivePresent / T) * 100);\n}\n\nreturn {\n  ...$json,\n  effectivePresent,\n  attendancePercent\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1216,
        5360
      ],
      "id": "acbe5825-8fe6-4afc-9d74-03d4147cb9ce",
      "name": "1.Mail Payload Synthesizer + Identity Guard"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const email = $json.to;\n\n// agar email missing ho ‚Üí item drop\nif (!email || email.trim() === '') {\n  return null;\n}\n\nconst T = Number($json.totals?.T || 0);\nconst P = Number($json.totals?.P || 0);\nconst H = Number($json.totals?.H || 0);\nconst L = Number($json.totals?.L || 0);\nconst A = Number($json.totals?.A || 0);\n\nlet effectivePresent = 0;\nlet attendancePercent = 0;\n\nif (T > 0) {\n  effectivePresent = P + H + (L * 0.5);\n  attendancePercent = Math.round((effectivePresent / T) * 100);\n}\n\nreturn {\n  ...$json,\n  effectivePresent,\n  attendancePercent\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1216,
        5664
      ],
      "id": "589ffc28-096d-450c-81bb-9d2addec15e2",
      "name": "1.1.Mail Payload Synthesizer + Identity Guard"
    },
    {
      "parameters": {
        "sendTo": "kingofpak111@gmail.com",
        "subject": "EDUVŒõULT ECOSYSTEM | Monthly Attendance Analysis Report",
        "message": "=Dear **Faculty Member**,  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; border-collapse:collapse; background:#e5e7eb;\">   <tr>     <td align=\"center\" style=\"padding:24px 0;\">  ```   <table width=\"720\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#ffffff; border-radius:6px; overflow:hidden;\">      <!-- HEADER -->     <tr>       <td style=\"padding:20px; background:#0f172a; color:#ffffff;\">         <strong style=\"font-size:20px; letter-spacing:0.5px;\">           EDUVŒõULT ECOSYSTEM         </strong><br>         <span style=\"font-size:12px; color:#cbd5e1;\">           Automated Academic Operations & Attendance Intelligence         </span>       </td>     </tr>      <!-- BODY -->     <tr>       <td style=\"padding:22px; background:#ffffff; color:#111827;\">          <p style=\"font-size:14px; line-height:1.6;\">           This email provides the <strong>official monthly attendance analysis</strong> generated by the             <strong>EDUVŒõULT ECOSYSTEM</strong> for the period outlined below.         </p>          <!-- META INFO -->         <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\" style=\"margin:16px 0; font-size:13px;\">           <tr>             <td width=\"220\"><strong>Reporting Month</strong></td>             <td>{{ $json.month }}</td>           </tr>           <tr>             <td><strong>System</strong></td>             <td>EDUVŒõULT ECOSYSTEM</td>           </tr>           <tr>             <td><strong>Generated On</strong></td>             <td>{{ new Date().toLocaleString() }}</td>           </tr>         </table>          <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:18px 0;\">          <!-- OVERALL SUMMARY -->         <p style=\"font-size:15px; font-weight:bold; margin-bottom:8px;\">           Overall Attendance Summary         </p>          <table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"1\"           style=\"border-collapse:collapse; font-size:13px; margin-bottom:18px;\">           <tr style=\"background:#f1f5f9;\">             <th align=\"left\">Metric</th>             <th align=\"left\">Value</th>           </tr>           <tr>             <td>Total Attendance Records</td>             <td>{{ $json.eduvaultSummary.totals.T }}</td>           </tr>           <tr>             <td>Present (P)</td>             <td>{{ $json.eduvaultSummary.totals.P }}</td>           </tr>           <tr>             <td>Half-Day / Holiday (H)</td>             <td>{{ $json.eduvaultSummary.totals.H }}</td>           </tr>           <tr>             <td>Leave (L)</td>             <td>{{ $json.eduvaultSummary.totals.L }}</td>           </tr>           <tr>             <td>Absent (A)</td>             <td>{{ $json.eduvaultSummary.totals.A }}</td>           </tr>           <tr style=\"background:#ecfeff;\">             <td><strong>Final Attendance Percentage</strong></td>             <td><strong>{{ $json.eduvaultSummary.attendancePercent }}%</strong></td>           </tr>         </table>          <!-- CLASS BREAKDOWN -->         <p style=\"font-size:15px; font-weight:bold; margin-bottom:8px;\">           Class-Wise Attendance Breakdown         </p>          <table width=\"100%\" cellpadding=\"8\" cellspacing=\"0\" border=\"1\"           style=\"border-collapse:collapse; font-size:13px;\">           <tr style=\"background:#f1f5f9;\">             <th align=\"left\">Class</th>             <th align=\"center\">T</th>             <th align=\"center\">P</th>             <th align=\"center\">H</th>             <th align=\"center\">L</th>             <th align=\"center\">A</th>             <th align=\"center\">%</th>           </tr>            {{ $json.classes.map(c => `           <tr>             <td>${c.class}</td>             <td align=\"center\">${c.totals.T}</td>             <td align=\"center\">${c.totals.P}</td>             <td align=\"center\">${c.totals.H}</td>             <td align=\"center\">${c.totals.L}</td>             <td align=\"center\">${c.totals.A}</td>             <td align=\"center\"><strong>${c.attendancePercent}%</strong></td>           </tr>           `).join('') }}          </table>          <p style=\"margin-top:18px; font-size:13px; color:#374151; line-height:1.6;\">           All attendance data is now <strong>locked</strong> and has been successfully synchronized           with monthly analytics, reports, and institutional dashboards.           No further action is required.         </p>        </td>     </tr>      <!-- FOOTER -->     <tr>       <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">         This is an automated notification generated by the <strong>EDUVŒõULT ECOSYSTEM</strong>.<br>         Please do not reply to this email.       </td>     </tr>    </table>  </td> ```    </tr> </table>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1488,
        5056
      ],
      "id": "98572880-15d6-45a9-b40c-fc984bad885d",
      "name": "EDUVŒõULT Command & Analytics Channel",
      "webhookId": "a95a348c-d6e6-4e02-9697-e30c08a0a912",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.to }}",
        "subject": "EDUVŒõULT ECOSYSTEM | Your Monthly Attendance Report",
        "message": "=Dear **Student**,\n\n<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; background:#e5e7eb;\">\n  <tr>\n    <td align=\"center\" style=\"padding:24px 0;\">\n      <table width=\"680\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#ffffff; border-radius:6px; overflow:hidden;\">\n\n```\n    <!-- HEADER -->\n    <tr>\n      <td style=\"padding:20px; background:#0f172a; color:#ffffff;\">\n        <strong style=\"font-size:20px;\">EDUVŒõULT ECOSYSTEM</strong><br>\n        <span style=\"font-size:12px; color:#cbd5e1;\">\n          Personal Academic Attendance Report\n        </span>\n      </td>\n    </tr>\n\n    <!-- BODY -->\n    <tr>\n      <td style=\"padding:22px; color:#111827;\">\n\n        <p style=\"font-size:14px; line-height:1.6;\">\n          This email contains your <strong>official attendance summary</strong> for the month listed below,\n          generated by the <strong>EDUVŒõULT ECOSYSTEM</strong>.\n        </p>\n\n        <!-- STUDENT META -->\n        <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\" style=\"margin:16px 0; font-size:13px;\">\n          <tr>\n            <td width=\"180\"><strong>Galaxy ID</strong></td>\n            <td>{{ $json.galaxy_id }}</td>\n          </tr>\n          <tr>\n            <td><strong>Class</strong></td>\n            <td>{{ $json.class }}</td>\n          </tr>\n          <tr>\n            <td><strong>Month</strong></td>\n            <td>{{ $json.month }}</td>\n          </tr>\n        </table>\n\n        <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:16px 0;\">\n\n        <!-- ATTENDANCE TABLE -->\n        <p style=\"font-size:15px; font-weight:bold; margin-bottom:8px;\">\n          Attendance Summary\n        </p>\n\n        <table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"1\"\n          style=\"border-collapse:collapse; font-size:13px;\">\n          <tr style=\"background:#f1f5f9;\">\n            <th align=\"center\">Total</th>\n            <th align=\"center\">Present</th>\n            <th align=\"center\">Holiday</th>\n            <th align=\"center\">Leave</th>\n            <th align=\"center\">Absent</th>\n          </tr>\n          <tr>\n            <td align=\"center\">{{ $json.totals.T }}</td>\n            <td align=\"center\">{{ $json.totals.P }}</td>\n            <td align=\"center\">{{ $json.totals.H }}</td>\n            <td align=\"center\">{{ $json.totals.L }}</td>\n            <td align=\"center\">{{ $json.totals.A }}</td>\n          </tr>\n        </table>\n\n        <!-- SCORE -->\n        <table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\"\n          style=\"margin-top:16px; background:#ecfeff; font-size:14px;\">\n          <tr>\n            <td>\n              <strong>Your Attendance Score:</strong>\n            </td>\n            <td align=\"right\">\n              <strong>{{ $json.attendancePercent }}%</strong>\n            </td>\n          </tr>\n        </table>\n\n        <p style=\"margin-top:16px; font-size:13px; color:#374151; line-height:1.6;\">\n          Consistent attendance is a key indicator of academic success.\n          Please ensure regular participation to maintain or improve your performance.\n        </p>\n\n      </td>\n    </tr>\n\n    <!-- FOOTER -->\n    <tr>\n      <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">\n        This is an automated report generated by the <strong>EDUVŒõULT ECOSYSTEM</strong>.<br>\n        Please do not reply to this email.\n      </td>\n    </tr>\n\n  </table>\n</td>\n```\n\n  </tr>\n</table>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1984,
        5344
      ],
      "id": "639d19c8-47bb-450d-85d5-94a3940ecc56",
      "name": "Personal Academic Presence Report",
      "webhookId": "f5481e20-0f61-4d73-ba41-e0db5ff6f008",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.to }}",
        "subject": "EDUVŒõULT ECOSYSTEM | Student Monthly Attendance Summary",
        "message": "=Dear **Parent / Guardian**,  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; background:#e5e7eb;\">   <tr>     <td align=\"center\" style=\"padding:24px 0;\">       <table width=\"680\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#ffffff; border-radius:6px; overflow:hidden;\">  ```     <!-- HEADER -->     <tr>       <td style=\"padding:20px; background:#0f172a; color:#ffffff;\">         <strong style=\"font-size:20px;\">EDUVŒõULT ECOSYSTEM</strong><br>         <span style=\"font-size:12px; color:#cbd5e1;\">           Guardian Attendance Overview         </span>       </td>     </tr>      <!-- BODY -->     <tr>       <td style=\"padding:22px; color:#111827;\">          <p style=\"font-size:14px; line-height:1.6;\">           This report provides an overview of your child's <strong>monthly attendance record</strong>,           prepared by the <strong>EDUVŒõULT ECOSYSTEM</strong>.         </p>          <!-- STUDENT META -->         <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\" style=\"margin:16px 0; font-size:13px;\">           <tr>             <td width=\"180\"><strong>Galaxy ID</strong></td>             <td>{{ $json.galaxy_id }}</td>           </tr>           <tr>             <td><strong>Class</strong></td>             <td>{{ $json.class }}</td>           </tr>           <tr>             <td><strong>Reporting Month</strong></td>             <td>{{ $json.month }}</td>           </tr>         </table>          <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:16px 0;\">          <!-- ATTENDANCE TABLE -->         <p style=\"font-size:15px; font-weight:bold; margin-bottom:8px;\">           Attendance Breakdown         </p>          <table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" border=\"1\"           style=\"border-collapse:collapse; font-size:13px;\">           <tr style=\"background:#f1f5f9;\">             <th align=\"center\">Total</th>             <th align=\"center\">Present</th>             <th align=\"center\">Holiday</th>             <th align=\"center\">Leave</th>             <th align=\"center\">Absent</th>           </tr>           <tr>             <td align=\"center\">{{ $json.totals.T }}</td>             <td align=\"center\">{{ $json.totals.P }}</td>             <td align=\"center\">{{ $json.totals.H }}</td>             <td align=\"center\">{{ $json.totals.L }}</td>             <td align=\"center\">{{ $json.totals.A }}</td>           </tr>         </table>          <!-- SCORE -->         <table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\"           style=\"margin-top:16px; background:#ecfeff; font-size:14px;\">           <tr>             <td>               <strong>Attendance Percentage:</strong>             </td>             <td align=\"right\">               <strong>{{ $json.attendancePercent }}%</strong>             </td>           </tr>         </table>          <p style=\"margin-top:16px; font-size:13px; color:#374151; line-height:1.6;\">           Regular attendance plays a critical role in academic progress.           We encourage guardians to review this report and support consistent participation.         </p>        </td>     </tr>      <!-- FOOTER -->     <tr>       <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">         This is an automated communication from the <strong>EDUVŒõULT ECOSYSTEM</strong>.<br>         Please do not reply to this email.       </td>     </tr>    </table> </td> ```    </tr> </table>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1984,
        5648
      ],
      "id": "37cbff47-f498-48b6-a9ca-e9f9c424e20a",
      "name": "EDUVŒõULT Guardian Visibility Channel",
      "webhookId": "bb15197d-dce1-432d-a38f-fbf47ddedd69",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1424,
        5360
      ],
      "id": "87c97d69-9817-4095-9282-43904d80aa0b",
      "name": "Sequential Dispatch Engine"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        1424,
        5664
      ],
      "id": "b05a91a7-94da-4a79-81db-914cbba17aeb",
      "name": "Sequential Dispatch Engine1"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "1.Replace Me",
      "typeVersion": 1,
      "position": [
        1632,
        5376
      ],
      "id": "401379fd-9127-4030-9fc3-0f75a4b669ef"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "name": "1.1.Replace Me",
      "typeVersion": 1,
      "position": [
        1632,
        5680
      ],
      "id": "656ba442-b4a4-48ae-946a-e05dcb93eee6"
    },
    {
      "parameters": {
        "height": 992,
        "width": 5008,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        3936
      ],
      "typeVersion": 1,
      "id": "20fec31d-fa48-4510-9cbf-de8d59d9cda2",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "Monthly Report & Notification Engine",
        "height": 1008,
        "width": 2192,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        4944
      ],
      "typeVersion": 1,
      "id": "23fee61d-b869-4242-b924-665865c70df0",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1IbEK_nTGsEpovlww-05ALJX4TyiraudbFFLu4AhJJJ4",
          "mode": "list",
          "cachedResultName": "EDUVŒõULT_Persist_Galaxy_Financial_Ledger",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IbEK_nTGsEpovlww-05ALJX4TyiraudbFFLu4AhJJJ4/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "={{ $json.class }}",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "Galaxy_ID": "={{ $json.galaxy_id }}",
            "Status": "={{ $json.status }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Galaxy_ID",
              "displayName": "Galaxy_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Full_Name",
              "displayName": "Full_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Email",
              "displayName": "Parent_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Class",
              "displayName": "Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Monthly_Fee",
              "displayName": "Monthly_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Student_Email",
              "displayName": "Student_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Dec_2025",
              "displayName": "Dec_2025",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_Fee",
              "displayName": "Dec_2025_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_Status",
              "displayName": "Dec_2025_Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_Receipt",
              "displayName": "Dec_2025_Receipt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_PaidAt",
              "displayName": "Dec_2025_PaidAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_FileId",
              "displayName": "Dec_2025_FileId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_FileUrl",
              "displayName": "Dec_2025_FileUrl",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2864,
        1440
      ],
      "id": "4e365a8c-2675-4427-a100-86b83cb75442",
      "name": "1.1.Persist_Galaxy_Financial_Ledger",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MXqLnUIS1ffcXbNH",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1xyLq6GeQcgmxF6DvsOJYpXSioH9o0KECsCRv_idz1ow",
          "mode": "list",
          "cachedResultName": "EDUVŒõULT_Persist_Galaxy_Attendance_Registry",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1xyLq6GeQcgmxF6DvsOJYpXSioH9o0KECsCRv_idz1ow/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "={{ $json.class }}",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "Galaxy_ID": "={{ $json.galaxy_id }}",
            "Status": "={{ $json.status }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Galaxy_ID",
              "displayName": "Galaxy_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Full_Name",
              "displayName": "Full_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Email",
              "displayName": "Parent_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Class",
              "displayName": "Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Student_Email",
              "displayName": "Student_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "A_Dec25_01",
              "displayName": "A_Dec25_01",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_02",
              "displayName": "A_Dec25_02",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_03",
              "displayName": "A_Dec25_03",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_04",
              "displayName": "A_Dec25_04",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_05",
              "displayName": "A_Dec25_05",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_06",
              "displayName": "A_Dec25_06",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_07",
              "displayName": "A_Dec25_07",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_08",
              "displayName": "A_Dec25_08",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_09",
              "displayName": "A_Dec25_09",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_10",
              "displayName": "A_Dec25_10",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_11",
              "displayName": "A_Dec25_11",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_12",
              "displayName": "A_Dec25_12",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_13",
              "displayName": "A_Dec25_13",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_14",
              "displayName": "A_Dec25_14",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_15",
              "displayName": "A_Dec25_15",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_16",
              "displayName": "A_Dec25_16",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_17",
              "displayName": "A_Dec25_17",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_18",
              "displayName": "A_Dec25_18",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_19",
              "displayName": "A_Dec25_19",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_20",
              "displayName": "A_Dec25_20",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_21",
              "displayName": "A_Dec25_21",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_22",
              "displayName": "A_Dec25_22",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_23",
              "displayName": "A_Dec25_23",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_24",
              "displayName": "A_Dec25_24",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_25",
              "displayName": "A_Dec25_25",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_26",
              "displayName": "A_Dec25_26",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_27",
              "displayName": "A_Dec25_27",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_28",
              "displayName": "A_Dec25_28",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_29",
              "displayName": "A_Dec25_29",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_30",
              "displayName": "A_Dec25_30",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_31",
              "displayName": "A_Dec25_31",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_T",
              "displayName": "A_Dec25_T",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_P",
              "displayName": "A_Dec25_P",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_A",
              "displayName": "A_Dec25_A",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_L",
              "displayName": "A_Dec25_L",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_H",
              "displayName": "A_Dec25_H",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2864,
        1664
      ],
      "id": "f58ed929-e74b-4f9f-b9ac-8972712cfe1f",
      "name": "1.1.Persist_Galaxy_Attendance_Registry",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MXqLnUIS1ffcXbNH",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1zMPWO7j_D0H87fkKbjLpQOxyrW3hbxCow1qT9rzH4UY",
          "mode": "list",
          "cachedResultName": "EDUVŒõULT_Persist_Galaxy_Core_Profile",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zMPWO7j_D0H87fkKbjLpQOxyrW3hbxCow1qT9rzH4UY/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "={{ $json.class }}",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "Left_campus_At": "={{ $json.left_campus_at }}",
            "Status": "={{ $json.status }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Galaxy_ID",
              "displayName": "Galaxy_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Roll_Number",
              "displayName": "Roll_Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Full_Name",
              "displayName": "Full_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Gender",
              "displayName": "Gender",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "DOB",
              "displayName": "DOB",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Class",
              "displayName": "Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Student_CNIC",
              "displayName": "Student_CNIC",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Type",
              "displayName": "Parent_Type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Name",
              "displayName": "Parent_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_CNIC",
              "displayName": "Parent_CNIC",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Student_Email",
              "displayName": "Student_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Email",
              "displayName": "Parent_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone_Primary",
              "displayName": "Phone_Primary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone_Secondary",
              "displayName": "Phone_Secondary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Admission_Fee",
              "displayName": "Admission_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Monthly_Fee",
              "displayName": "Monthly_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Scholarship_Percent",
              "displayName": "Scholarship_Percent",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Admission_Year",
              "displayName": "Admission_Year",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Created_At",
              "displayName": "Created_At",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Left_campus_At",
              "displayName": "Left_campus_At",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Rejoined_after_break_At",
              "displayName": "Rejoined_after_break_At",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Class_Sheet",
              "displayName": "Class_Sheet",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ok",
              "displayName": "ok",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "lastRow",
              "displayName": "lastRow",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2864,
        1888
      ],
      "id": "8371cc57-0e9f-4013-941e-610dbf629cf2",
      "name": "1.1.Persist_Galaxy_Core_Profile",
      "alwaysOutputData": false,
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MXqLnUIS1ffcXbNH",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1xyLq6GeQcgmxF6DvsOJYpXSioH9o0KECsCRv_idz1ow",
          "mode": "list",
          "cachedResultName": "EDUVŒõULT_Persist_Galaxy_Financial_Ledger",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1xyLq6GeQcgmxF6DvsOJYpXSioH9o0KECsCRv_idz1ow/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "={{ $json.class }}",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "Status": "={{ $json.status }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Galaxy_ID",
              "displayName": "Galaxy_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Full_Name",
              "displayName": "Full_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Email",
              "displayName": "Parent_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Class",
              "displayName": "Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Monthly_Fee",
              "displayName": "Monthly_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Student_Email",
              "displayName": "Student_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Dec_2025",
              "displayName": "Dec_2025",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_Fee",
              "displayName": "Dec_2025_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_Status",
              "displayName": "Dec_2025_Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_Receipt",
              "displayName": "Dec_2025_Receipt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_PaidAt",
              "displayName": "Dec_2025_PaidAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_FileId",
              "displayName": "Dec_2025_FileId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_FileUrl",
              "displayName": "Dec_2025_FileUrl",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2864,
        1184
      ],
      "id": "3541c72e-5d34-4569-bc44-472226c9e4ac",
      "name": "1.2.Persist_Galaxy_Financial_Ledger",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MXqLnUIS1ffcXbNH",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1xyLq6GeQcgmxF6DvsOJYpXSioH9o0KECsCRv_idz1ow",
          "mode": "list",
          "cachedResultName": "EDUVŒõULT_Persist_Galaxy_Attendance_Registry",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1xyLq6GeQcgmxF6DvsOJYpXSioH9o0KECsCRv_idz1ow/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "={{ $json.class }}",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "Status": "={{ $json.status }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Galaxy_ID",
              "displayName": "Galaxy_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Full_Name",
              "displayName": "Full_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Email",
              "displayName": "Parent_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Class",
              "displayName": "Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Student_Email",
              "displayName": "Student_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A_Dec25_01",
              "displayName": "A_Dec25_01",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_02",
              "displayName": "A_Dec25_02",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_03",
              "displayName": "A_Dec25_03",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_04",
              "displayName": "A_Dec25_04",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_05",
              "displayName": "A_Dec25_05",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_06",
              "displayName": "A_Dec25_06",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_07",
              "displayName": "A_Dec25_07",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_08",
              "displayName": "A_Dec25_08",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_09",
              "displayName": "A_Dec25_09",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_10",
              "displayName": "A_Dec25_10",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_11",
              "displayName": "A_Dec25_11",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_12",
              "displayName": "A_Dec25_12",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_13",
              "displayName": "A_Dec25_13",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_14",
              "displayName": "A_Dec25_14",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_15",
              "displayName": "A_Dec25_15",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_16",
              "displayName": "A_Dec25_16",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_17",
              "displayName": "A_Dec25_17",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_18",
              "displayName": "A_Dec25_18",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_19",
              "displayName": "A_Dec25_19",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_20",
              "displayName": "A_Dec25_20",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_21",
              "displayName": "A_Dec25_21",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_22",
              "displayName": "A_Dec25_22",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_23",
              "displayName": "A_Dec25_23",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_24",
              "displayName": "A_Dec25_24",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_25",
              "displayName": "A_Dec25_25",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_26",
              "displayName": "A_Dec25_26",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_27",
              "displayName": "A_Dec25_27",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_28",
              "displayName": "A_Dec25_28",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_29",
              "displayName": "A_Dec25_29",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_30",
              "displayName": "A_Dec25_30",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_31",
              "displayName": "A_Dec25_31",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_T",
              "displayName": "A_Dec25_T",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_P",
              "displayName": "A_Dec25_P",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_A",
              "displayName": "A_Dec25_A",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_L",
              "displayName": "A_Dec25_L",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_H",
              "displayName": "A_Dec25_H",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2864,
        960
      ],
      "id": "30a5ec9f-26f1-4d3c-bd3b-210ed5effce9",
      "name": "1.2.Persist_Galaxy_Attendance_Registry",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MXqLnUIS1ffcXbNH",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1zMPWO7j_D0H87fkKbjLpQOxyrW3hbxCow1qT9rzH4UY",
          "mode": "list",
          "cachedResultName": "EDUVŒõULT_Persist_Galaxy_Core_Profile",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1zMPWO7j_D0H87fkKbjLpQOxyrW3hbxCow1qT9rzH4UY/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "={{ $json.class }}",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "row_number": "={{ $json.row_number }}",
            "Status": "={{ $json.status }}",
            "Rejoined_after_break_At": "={{ $json.rejoined_after_break_at }}"
          },
          "matchingColumns": [
            "row_number"
          ],
          "schema": [
            {
              "id": "Galaxy_ID",
              "displayName": "Galaxy_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Roll_Number",
              "displayName": "Roll_Number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Full_Name",
              "displayName": "Full_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Gender",
              "displayName": "Gender",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "DOB",
              "displayName": "DOB",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Class",
              "displayName": "Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Student_CNIC",
              "displayName": "Student_CNIC",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Type",
              "displayName": "Parent_Type",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Name",
              "displayName": "Parent_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_CNIC",
              "displayName": "Parent_CNIC",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Student_Email",
              "displayName": "Student_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Parent_Email",
              "displayName": "Parent_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone_Primary",
              "displayName": "Phone_Primary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Phone_Secondary",
              "displayName": "Phone_Secondary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Address",
              "displayName": "Address",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Admission_Fee",
              "displayName": "Admission_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Monthly_Fee",
              "displayName": "Monthly_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Scholarship_Percent",
              "displayName": "Scholarship_Percent",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Admission_Year",
              "displayName": "Admission_Year",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Created_At",
              "displayName": "Created_At",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Left_campus_At",
              "displayName": "Left_campus_At",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Rejoined_after_break_At",
              "displayName": "Rejoined_after_break_At",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Class_Sheet",
              "displayName": "Class_Sheet",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "ok",
              "displayName": "ok",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "lastRow",
              "displayName": "lastRow",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "row_number",
              "displayName": "row_number",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "number",
              "canBeUsedToMatch": true,
              "readOnly": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2864,
        720
      ],
      "id": "ffb3e06e-48ca-4a3a-ae2a-ad7f52b14633",
      "name": "1.2.Persist_Galaxy_Core_Profile",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MXqLnUIS1ffcXbNH",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "height": 1440,
        "width": 1328,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1792,
        672
      ],
      "typeVersion": 1,
      "id": "08246c3c-3279-4159-825b-85035a4880ca",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1xyLq6GeQcgmxF6DvsOJYpXSioH9o0KECsCRv_idz1ow",
          "mode": "list",
          "cachedResultName": "EDUVŒõULT_Persist_Galaxy_Financial_Ledger",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1xyLq6GeQcgmxF6DvsOJYpXSioH9o0KECsCRv_idz1ow/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "={{ $('Forge_Galaxy_Identity').item.json.Class_Sheet }}",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Galaxy_ID": "={{ $('Forge_Galaxy_Identity').item.json.Galaxy_ID }}",
            "Class": "={{ $('Forge_Galaxy_Identity').item.json.Class }}",
            "Full_Name": "={{ $('Forge_Galaxy_Identity').item.json.Full_Name }}",
            "Parent_Email": "={{ $('Forge_Galaxy_Identity').item.json.Parent_Email }}",
            "Student_Email": "={{ $('Forge_Galaxy_Identity').item.json.Student_Email }}",
            "Status": "={{ $('Forge_Galaxy_Identity').item.json.Status }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Galaxy_ID",
              "displayName": "Galaxy_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Full_Name",
              "displayName": "Full_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Parent_Email",
              "displayName": "Parent_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Class",
              "displayName": "Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Student_Email",
              "displayName": "Student_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "A_Dec25_01",
              "displayName": "A_Dec25_01",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_02",
              "displayName": "A_Dec25_02",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_03",
              "displayName": "A_Dec25_03",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_04",
              "displayName": "A_Dec25_04",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_05",
              "displayName": "A_Dec25_05",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_06",
              "displayName": "A_Dec25_06",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_07",
              "displayName": "A_Dec25_07",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_08",
              "displayName": "A_Dec25_08",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_09",
              "displayName": "A_Dec25_09",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_10",
              "displayName": "A_Dec25_10",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_11",
              "displayName": "A_Dec25_11",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_12",
              "displayName": "A_Dec25_12",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_13",
              "displayName": "A_Dec25_13",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_14",
              "displayName": "A_Dec25_14",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_15",
              "displayName": "A_Dec25_15",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_16",
              "displayName": "A_Dec25_16",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_17",
              "displayName": "A_Dec25_17",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_18",
              "displayName": "A_Dec25_18",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_19",
              "displayName": "A_Dec25_19",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_20",
              "displayName": "A_Dec25_20",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_21",
              "displayName": "A_Dec25_21",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_22",
              "displayName": "A_Dec25_22",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_23",
              "displayName": "A_Dec25_23",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_24",
              "displayName": "A_Dec25_24",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_25",
              "displayName": "A_Dec25_25",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_26",
              "displayName": "A_Dec25_26",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_27",
              "displayName": "A_Dec25_27",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_28",
              "displayName": "A_Dec25_28",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_29",
              "displayName": "A_Dec25_29",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_30",
              "displayName": "A_Dec25_30",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_31",
              "displayName": "A_Dec25_31",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_T",
              "displayName": "A_Dec25_T",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_P",
              "displayName": "A_Dec25_P",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_A",
              "displayName": "A_Dec25_A",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_L",
              "displayName": "A_Dec25_L",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "A_Dec25_H",
              "displayName": "A_Dec25_H",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1472,
        688
      ],
      "id": "db2fd280-6314-4b40-81ee-5fe8bb38f731",
      "name": "Persist_Galaxy_Financial_Ledger",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MXqLnUIS1ffcXbNH",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1IbEK_nTGsEpovlww-05ALJX4TyiraudbFFLu4AhJJJ4",
          "mode": "list",
          "cachedResultName": "EDUVŒõULT_Persist_Galaxy_Attendance_Registry",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1IbEK_nTGsEpovlww-05ALJX4TyiraudbFFLu4AhJJJ4/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": "={{ $('Assemble_Galaxy_Identity_Context').item.json.Class_Sheet }}",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Galaxy_ID": "={{ $json.Galaxy_ID }}",
            "Full_Name": "={{ $json.Full_Name }}",
            "Parent_Email": "={{ $json.Parent_Email }}",
            "Class": "={{ $json.Class }}",
            "Monthly_Fee": "={{ $json.Monthly_Fee }}",
            "Student_Email": "={{ $json.Student_Email }}",
            "Status": "={{ $json.Status }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Galaxy_ID",
              "displayName": "Galaxy_ID",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Full_Name",
              "displayName": "Full_Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Parent_Email",
              "displayName": "Parent_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Class",
              "displayName": "Class",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Monthly_Fee",
              "displayName": "Monthly_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Student_Email",
              "displayName": "Student_Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Dec_2025",
              "displayName": "Dec_2025",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_Fee",
              "displayName": "Dec_2025_Fee",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_Status",
              "displayName": "Dec_2025_Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_Receipt",
              "displayName": "Dec_2025_Receipt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_PaidAt",
              "displayName": "Dec_2025_PaidAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_FileId",
              "displayName": "Dec_2025_FileId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            },
            {
              "id": "Dec_2025_FileUrl",
              "displayName": "Dec_2025_FileUrl",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1472,
        272
      ],
      "id": "e0818d8a-3318-43e8-a705-020e675c8f32",
      "name": "Persist_Galaxy_Attendance_Registry",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "MXqLnUIS1ffcXbNH",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const results = [];\n\nfor (const item of items) {\n\n  const data = item.json;\n\n  // ---- NORMALIZE KEYS (case safe) ----\n  const galaxyId =\n    data.galaxy_id ||\n    data.Galaxy_ID ||\n    data.galaxyId;\n\n  const status =\n    data.status ||\n    data.Status;\n\n  if (!galaxyId || typeof galaxyId !== 'string') {\n    results.push({\n      json: {\n        error: \"Galaxy_ID missing or invalid\",\n        original: data\n      }\n    });\n    continue;\n  }\n\n  // ---- FIX GALAXY ID FORMAT ----\n  // S-AA25-06-05mn  ‚Üí  S-AA25-06-05-mn\n  const normalizedGalaxyId = galaxyId.replace(/(\\d{2})(mn)$/i, '$1-mn');\n\n  const parts = normalizedGalaxyId.split('-');\n\n  if (parts.length < 4) {\n    results.push({\n      json: {\n        error: \"Invalid Galaxy_ID format\",\n        galaxy_id: galaxyId\n      }\n    });\n    continue;\n  }\n\n  // ---- CLASS ----\n  const classNumber = parts[2]; // \"06\"\n  const className = `Class_${classNumber}`;\n\n  // ---- ROW NUMBER ----\n  const rollRaw = parts[3]; // \"05\"\n  const rollNumber = parseInt(rollRaw, 10);\n\n  if (isNaN(rollNumber)) {\n    results.push({\n      json: {\n        error: \"Invalid roll number in Galaxy_ID\",\n        galaxy_id: galaxyId\n      }\n    });\n    continue;\n  }\n\n  const row_number = rollNumber + 1;\n\n  // ---- TIME ----\n  const nowISO = new Date().toISOString();\n\n  let left_campus_at = null;\n  let rejoined_after_break_at = null;\n\n  if (status === 'Inactive') {\n    left_campus_at = nowISO;\n  }\n\n  if (status === 'Active') {\n    rejoined_after_break_at = nowISO;\n  }\n\n  // ---- FINAL OUTPUT ITEM ----\n  results.push({\n    json: {\n      galaxy_id: normalizedGalaxyId,\n      class: className,\n      status: status,\n      left_campus_at,\n      rejoined_after_break_at,\n      row_number\n    }\n  });\n}\n\nreturn results;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2128,
        1312
      ],
      "id": "ccb20556-9efd-4a5e-a8b0-aa295a966baa",
      "name": "EDUVŒõULT | Galaxy Identity Resolution Engine (GIRE)"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "87c659d0-5fa9-4225-8889-cc763815dea4",
              "leftValue": "={{ $json.status }}",
              "rightValue": "Active",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2368,
        1312
      ],
      "id": "dbd3d4b4-dea4-4f06-bcac-0309112d80ba",
      "name": "Lifecycle State Gatekeeper"
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\n\nlet total_pending_amount = 0;\nlet unpaid_list = [];\n\nfor (const item of items) {\n  const students = item.json.students || [];\n\n  for (const s of students) {\n    if (s.Month_Status === 'UNPAID') {\n      total_pending_amount += Number(s.Monthly_Fee || 0);\n\n      unpaid_list.push({\n        Galaxy_ID: s.Galaxy_ID,\n        Full_Name: s.Full_Name,\n        Monthly_Fee: s.Monthly_Fee,\n        Class: s.Class,\n      });\n    }\n  }\n}\n\nreturn [\n  {\n    json: {\n      month: items[0]?.json?.month,\n      total_count: items[0]?.json?.total_count,\n      active_count: items[0]?.json?.active_count,\n      inactive_count: items[0]?.json?.inactive_count,\n      paid_count: items[0]?.json?.paid_count,\n      unpaid_count: unpaid_list.length,\n      total_pending_amount,\n      unpaid_students: unpaid_list,\n      report_date: new Date().toLocaleString(),\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        896,
        3232
      ],
      "id": "475ba592-836d-43f1-b82f-74afbc416dec",
      "name": "Financial_Delinquency_Aggregator"
    },
    {
      "parameters": {
        "jsCode": "const monthMap = {\n  January: 'Jan', February: 'Feb', March: 'Mar',\n  April: 'Apr', May: 'May', June: 'Jun',\n  July: 'Jul', August: 'Aug', September: 'Sep',\n  October: 'Oct', November: 'Nov', December: 'Dec'\n};\n\n// ALWAYS read month/year from the ORIGINAL trigger\nconst base = $input.first().json;\n\nconst m = base.Month;\nconst y = base.Year;\n\n// reminder_type comes from Set Reminder Type node\nconst reminderType = $json.reminder_type;\n\nreturn [\n  {\n    json: {\n      month: m,\n      year: y,\n      monthKey: `${monthMap[m]}_${y}`,\n      statusKey: `${monthMap[m]}_${y}_Status`,\n      reminder_type: reminderType\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        800,
        2976
      ],
      "id": "070863f5-a7ec-45d9-bbed-d8db8fa4b574",
      "name": "Column_Namespace_Compiler1"
    },
    {
      "parameters": {
        "jsCode": "// Input: merged item (1 item expected)\n\nconst input = items[0].json;\n\n// -------- BASIC FIELDS --------\nconst targetAudience = input.Target_Audience || null;\nconst messageType = input.Message_Type || null;\nconst polishedMessage =\n  input.message?.content || input.polished_message || \"\";\n\n// -------- CLASS PARSING --------\nconst rawClass = (input.Class_Selection || \"\").toString().toLowerCase();\n\nlet classes = [];\n\n// CASE 1: ALL classes\nif (rawClass.includes(\"all\")) {\n  for (let i = 1; i <= 12; i++) {\n    classes.push(`Class_${String(i).padStart(2, \"0\")}`);\n  }\n} else {\n  // CASE 2: numbers like 1,2,3,7,9\n  const nums = rawClass.match(/\\d+/g) || [];\n\n  classes = nums.map(n => `Class_${String(n).padStart(2, \"0\")}`);\n}\n\n// Remove duplicates (safety)\nclasses = [...new Set(classes)];\n\n// -------- FINAL STRUCTURE --------\nreturn [\n  {\n    json: {\n      targetAudience,\n      messageType,\n      polishedMessage,\n      classes,\n      submittedAt: input.submittedAt || new Date().toISOString(),\n      source: \"EDUVAULT_BROADCAST_SYSTEM\"\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1504,
        6480
      ],
      "id": "bb6790fc-3ac2-4ad4-b8f2-096a578f0205",
      "name": "Normalize_Broadcast_Command"
    },
    {
      "parameters": {
        "fieldToSplitOut": "classes",
        "include": "allOtherFields",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        1760,
        6480
      ],
      "id": "aa29cb2d-2252-4443-895b-fb3553c9896e",
      "name": "Split_Target_Classes"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbz-i-PTMGmCgrxgwRsZB3aB_MSlmY102Lhi99TjUUO4fYSU3KLkcEUg_dox7bDQi4w9/exec",
        "sendBody": true,
        "contentType": "raw",
        "rawContentType": "application/json",
        "body": "={   \n\"action\": \"fetchClassStudents\",   \n\"secret\": \"EDUVAULT_BROADCAST_2025\",   \n\"class\": \"{{ $json.classes }}\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1760,
        6320
      ],
      "id": "b41802cf-340d-4367-b6c2-f30ec6f931b4",
      "name": "HTTP_Fetch_Class_Student_Registry"
    },
    {
      "parameters": {
        "jsCode": "// Take the first (and only) item\nconst data = items[0].json;\n\n// Create a shallow copy\nconst cleaned = { ...data };\n\n// Remove ONLY the classes array\ndelete cleaned.classes;\n\n// Return SINGLE item\nreturn [\n  {\n    json: cleaned\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2672,
        6496
      ],
      "id": "b05ad351-d006-4517-8693-1e9fde8f9ca3",
      "name": "Remove_Classes_Array"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// This runs ONCE PER ITEM ‚Äî so count stays same\n\nconst payload = { ...$json };\n\n// Safety normalize\nconst audience = (payload.targetAudience || '').trim();\n\n// Build envelope\nreturn {\n  targetAudience: audience,   // üëà HEAD (for IF / SWITCH)\n  payload                    // üëà ALL original data inside\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2256,
        6496
      ],
      "id": "b4ed52fd-b1df-4d8e-9b63-1df35532af96",
      "name": "Build_Audience_Routing_Envelope"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "39901d45-45c1-4057-9f32-4bb1ebfcabca",
              "leftValue": "={{ $json.targetAudience }}",
              "rightValue": "Parents",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2464,
        6496
      ],
      "id": "42739431-c7e4-49ad-9981-bec92210d1c0",
      "name": "IF_Target_Audience_Router"
    },
    {
      "parameters": {
        "sendTo": "={{ $json.payload.students.Student_Email }}",
        "subject": "=EDUVŒõULT ECOSYSTEM | {{ $json.payload.messageType }} Notification",
        "message": "=Dear **Student**,\n\n<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; background:#e5e7eb;\">\n  <tr>\n    <td align=\"center\" style=\"padding:24px 0;\">\n      <table width=\"680\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#ffffff; border-radius:6px; overflow:hidden;\">\n\n```\n    <!-- HEADER -->\n    <tr>\n      <td style=\"padding:20px; background:#0f172a; color:#ffffff;\">\n        <strong style=\"font-size:20px; letter-spacing:0.4px;\">\n          EDUVŒõULT ECOSYSTEM\n        </strong><br>\n        <span style=\"font-size:12px; color:#cbd5e1;\">\n          Official Student Communication\n        </span>\n      </td>\n    </tr>\n\n    <!-- BODY -->\n    <tr>\n      <td style=\"padding:22px; color:#111827;\">\n\n        <p style=\"font-size:14px; line-height:1.6;\">\n          This is an official notification issued via the\n          <strong>EDUVŒõULT ECOSYSTEM</strong>.\n        </p>\n\n        <!-- MAIN MESSAGE (HIGHLIGHTED) -->\n        <table width=\"100%\" cellpadding=\"14\" cellspacing=\"0\"\n          style=\"margin:18px 0; background:#ecfeff; border-left:5px solid #0284c7;\">\n          <tr>\n            <td>\n              <p style=\"margin:0; font-size:13px; color:#0369a1; font-weight:bold; letter-spacing:0.5px;\">\n                IMPORTANT NOTICE\n              </p>\n              <p style=\"margin:6px 0 0 0; font-size:16px; font-weight:bold; color:#0f172a;\">\n                {{ $json.payload.polishedMessage }}\n              </p>\n            </td>\n          </tr>\n        </table>\n\n        <!-- STUDENT META -->\n        <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\"\n          style=\"margin:18px 0; font-size:13px; background:#f8fafc;\">\n          <tr>\n            <td width=\"160\"><strong>Galaxy ID</strong></td>\n            <td>{{ $json.payload.students.Galaxy_ID }}</td>\n          </tr>\n        </table>\n\n        <p style=\"margin-top:18px; font-size:13px; color:#374151; line-height:1.6;\">\n          Please take note of this announcement and act accordingly.\n          Staying informed is essential for academic discipline and continuity.\n        </p>\n\n      </td>\n    </tr>\n\n    <!-- FOOTER -->\n    <tr>\n      <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">\n        This is an automated message generated by the\n        <strong>EDUVŒõULT ECOSYSTEM</strong>.<br>\n        Please do not reply to this email.\n      </td>\n    </tr>\n\n  </table>\n</td>\n```\n\n  </tr>\n</table>\n{{ $json.payload.submittedAt }}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        4256,
        6800
      ],
      "id": "4c6925d6-685d-4c9a-9b85-f2b0df4902d4",
      "name": "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Student Notification Dispatch",
      "webhookId": "538eeb7d-a298-49f4-b757-1971ea16ab92",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "={{ $json.payload.students.Parent_Email }}",
        "subject": "=EDUVŒõULT ECOSYSTEM | {{ $json.payload.students.Galaxy_ID }} Notification",
        "message": "=Dear **Parent / Guardian**,  <table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; background:#e5e7eb;\">   <tr>     <td align=\"center\" style=\"padding:24px 0;\">       <table width=\"680\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#ffffff; border-radius:6px; overflow:hidden;\">  ```     <!-- HEADER -->     <tr>       <td style=\"padding:20px; background:#0f172a; color:#ffffff;\">         <strong style=\"font-size:20px; letter-spacing:0.4px;\">           EDUVŒõULT ECOSYSTEM         </strong><br>         <span style=\"font-size:12px; color:#cbd5e1;\">           Official Parent Communication         </span>       </td>     </tr>      <!-- BODY -->     <tr>       <td style=\"padding:22px; color:#111827;\">          <p style=\"font-size:14px; line-height:1.6;\">           This is an official notification issued for parents and guardians through the           <strong>EDUVŒõULT ECOSYSTEM</strong>.         </p>          <!-- MAIN MESSAGE (HIGHLIGHTED) -->         <table width=\"100%\" cellpadding=\"14\" cellspacing=\"0\"           style=\"margin:18px 0; background:#fefce8; border-left:5px solid #ca8a04;\">           <tr>             <td>               <p style=\"margin:0; font-size:13px; color:#92400e; font-weight:bold; letter-spacing:0.5px;\">                 IMPORTANT PARENT NOTICE               </p>               <p style=\"margin:6px 0 0 0; font-size:16px; font-weight:bold; color:#0f172a;\">                {{ $json.payload.polishedMessage }}                 </p>             </td>           </tr>         </table>          <!-- STUDENT REFERENCE -->         <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\"           style=\"margin:18px 0; font-size:13px; background:#f8fafc;\">           <tr>             <td width=\"180\"><strong>Student Galaxy ID</strong></td>             <td>{{ $json.payload.students.Galaxy_ID }}</td>           </tr>         </table>          <p style=\"margin-top:18px; font-size:13px; color:#374151; line-height:1.6;\">           Kindly ensure that your child is informed and complies with this notice.           Parental awareness and cooperation are essential for smooth academic operations.         </p>        </td>     </tr>      <!-- FOOTER -->     <tr>       <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">         This is an automated message generated by the         <strong>EDUVŒõULT ECOSYSTEM</strong>.<br>         Please do not reply to this email.       </td>     </tr>    </table> </td> ```    </tr> </table>\n{{ $json.payload.submittedAt }}",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        3088,
        6144
      ],
      "id": "359748ac-268a-483a-9991-4f0e301a0228",
      "name": "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Parent Notification Dispatch",
      "webhookId": "39e5566b-31af-4ab4-afa5-a2fae9379d1b",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "return [\n  {\n    type: \"RAW_TEXT\",\n    raw_message: $json.Raw_Message\n  },\n  {\n    type: \"CONTEXT\",\n    Target_Audience: $json.Target_Audience,\n    Class_Selection: $json.Class_Selection,\n    Message_Type: $json.Message_Type,\n    submittedAt: $json.submittedAt\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        288,
        6480
      ],
      "id": "e44139a9-edc2-4c76-bcc6-23027ee17dcf",
      "name": "Detect_Input_Type"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "dac1135f-897f-4f7d-831f-65483761cf31",
              "leftValue": "={{ $json.type }}",
              "rightValue": "RAW_TEXT",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        496,
        6480
      ],
      "id": "b393f7af-7c9e-457c-a670-10ce1ae72b43",
      "name": "IF_Raw_Text_Input"
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "gpt-4o-mini",
          "mode": "list",
          "cachedResultName": "GPT-4O-MINI"
        },
        "messages": {
          "values": [
            {
              "content": "=Rewrite the following message into clear, professional English.\nRules:\n- Formal tone\n- Short and clear\n- No emojis\n- No extra explanation\n\nMessage:\n{{ $json.raw_message }}\n"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "typeVersion": 1.8,
      "position": [
        816,
        6464
      ],
      "id": "5d96c08a-9ff6-4559-b86e-2904f906ca2d",
      "name": "AI_Message_Polisher",
      "credentials": {
        "openAiApi": {
          "id": "QFs3TUvXUfmMqfg0",
          "name": "n8n free OpenAI API credits"
        }
      }
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1280,
        6480
      ],
      "id": "32dc7f0d-289d-47ec-9b7a-a89ee4ae9abe",
      "name": "Merge_Polished_Message_With_Context"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        2064,
        6496
      ],
      "id": "31601c90-3ee3-41ba-8b58-17c83460974e",
      "name": "Merge_Student_With_Broadcast_Context"
    },
    {
      "parameters": {
        "fieldToSplitOut": "students",
        "include": "allOtherFields",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        2064,
        6320
      ],
      "id": "5da32aac-d127-4100-8058-2fb215110781",
      "name": "Split_Students_Per_Recipient"
    },
    {
      "parameters": {
        "jsCode": "const output = [];\n\nfor (const item of items) {\n  const cloned = JSON.parse(JSON.stringify(item.json));\n\n  // SAFETY: ensure structure\n  const student = cloned.payload?.students || {};\n\n  // üö´ REMOVE student email permanently (Parents pipeline)\n  if (student.Student_Email !== undefined) {\n    delete student.Student_Email;\n  }\n\n  // üìß Parent email detection\n  const parentEmail = student.Parent_Email;\n\n  if (parentEmail && String(parentEmail).trim() !== '') {\n    cloned.mode = 'SEND';\n  } else {\n    cloned.mode = 'MISSING';\n\n    // add report-friendly info\n    cloned.missingReason = 'PARENT_EMAIL_MISSING';\n    cloned.missingEmailFor = 'Parents';\n    cloned.missingGalaxyID = student.Galaxy_ID || null;\n  }\n\n  output.push(cloned);\n}\n\nreturn output;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2768,
        6192
      ],
      "id": "86f1150a-d062-4672-aba9-1c995eebd113",
      "name": "Code_Parents_Detect_Send_Or_Missing"
    },
    {
      "parameters": {
        "jsCode": "const output = [];\n\nfor (const item of items) {\n  const cloned = JSON.parse(JSON.stringify(item.json));\n\n  const student = cloned.payload?.students || {};\n\n  // üö´ REMOVE parent email permanently (Students pipeline)\n  if (student.Parent_Email !== undefined) {\n    delete student.Parent_Email;\n  }\n\n  // üìß Student email detection\n  const studentEmail = student.Student_Email;\n\n  if (studentEmail && String(studentEmail).trim() !== '') {\n    cloned.mode = 'SEND';\n  } else {\n    cloned.mode = 'MISSING';\n\n    // add report-friendly info\n    cloned.missingReason = 'STUDENT_EMAIL_MISSING';\n    cloned.missingEmailFor = 'Students';\n    cloned.missingGalaxyID = student.Galaxy_ID || null;\n  }\n\n  output.push(cloned);\n}\n\nreturn output;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2768,
        6816
      ],
      "id": "83c723dc-f992-4c6d-9849-a0579be5ed8f",
      "name": "Code_Students_Detect_Send_Or_Missing"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "dc8c7a4a-8838-4bb6-8b67-ab52398afc9d",
              "leftValue": "={{ $json.mode }}",
              "rightValue": "SEND",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3344,
        6192
      ],
      "id": "c5377e83-48df-4b73-9a7f-b99369964b7d",
      "name": "1.IF_Mode_Is_SEND"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "5475a6f4-d6bc-48b9-8760-9b4b8eb85710",
              "leftValue": "={{ $json.mode }}",
              "rightValue": "SEND",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3392,
        6816
      ],
      "id": "48c8bb0f-8e2d-4dda-877c-495ea254c2c5",
      "name": "1.1.IF_Mode_Is_SEND"
    },
    {
      "parameters": {
        "jsCode": "const sent = [];\nconst missing = [];\n\nfor (const item of items) {\n\n  // CASE 1: Missing email records (custom objects)\n  if (item.json.reason && item.json.galaxyId) {\n    missing.push({\n      targetAudience: item.json.targetAudience,\n      galaxyId: item.json.galaxyId,\n      reason: item.json.reason\n    });\n    continue;\n  }\n\n  // CASE 2: Sent records (payload exists)\n  const payload = item.json.payload;\n  const student = payload?.students;\n\n  if (student && student.Galaxy_ID) {\n    sent.push({\n      galaxyId: student.Galaxy_ID,\n      email: student.Parent_Email || student.Student_Email || 'UNKNOWN'\n    });\n  }\n}\n\nreturn [{\n  json: {\n    adminReport: {\n      summary: {\n        sentCount: sent.length,\n        missingCount: missing.length\n      },\n      sent,\n      missing\n    }\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2992,
        6864
      ],
      "id": "4606778a-d7f2-4bbd-9879-2295a5db5c0e",
      "name": "1.1.Code_Combine_Admin_Report"
    },
    {
      "parameters": {
        "jsCode": "const sent = [];\nconst missing = [];\n\nfor (const item of items) {\n\n  // CASE 1: Missing email records (custom objects)\n  if (item.json.reason && item.json.galaxyId) {\n    missing.push({\n      targetAudience: item.json.targetAudience,\n      galaxyId: item.json.galaxyId,\n      reason: item.json.reason\n    });\n    continue;\n  }\n\n  // CASE 2: Sent records (payload exists)\n  const payload = item.json.payload;\n  const student = payload?.students;\n\n  if (student && student.Galaxy_ID) {\n    sent.push({\n      galaxyId: student.Galaxy_ID,\n      email: student.Parent_Email || student.Student_Email || 'UNKNOWN'\n    });\n  }\n}\n\nreturn [{\n  json: {\n    adminReport: {\n      summary: {\n        sentCount: sent.length,\n        missingCount: missing.length\n      },\n      sent,\n      missing\n    }\n  }\n}];\n\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2960,
        6384
      ],
      "id": "7551f8fc-ead9-4e84-bb99-ee54b45815eb",
      "name": "1.Code_Combine_Admin_Report"
    },
    {
      "parameters": {
        "sendTo": "kingofpak111@gmail.com",
        "subject": "EDUVŒõULT ECOSYSTEM | Broadcast Dispatch Summary Report",
        "message": "=<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; background:#f1f5f9;\">\n  <tr>\n    <td align=\"center\" style=\"padding:26px 0;\">\n      <table width=\"720\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#ffffff; border-radius:8px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.06);\">\n\n```\n    <!-- HEADER -->\n    <tr>\n      <td style=\"padding:22px; background:#0f172a; color:#ffffff;\">\n        <div style=\"font-size:20px; font-weight:700; letter-spacing:0.4px;\">\n          EDUVŒõULT ECOSYSTEM\n        </div>\n        <div style=\"font-size:12px; color:#cbd5e1; margin-top:4px;\">\n          Broadcast Dispatch ‚Äî Administrative Report\n        </div>\n      </td>\n    </tr>\n\n    <!-- INTRO -->\n    <tr>\n      <td style=\"padding:22px; color:#111827;\">\n        <p style=\"margin:0; font-size:14px; line-height:1.7;\">\n          This is an automated administrative report summarizing the outcome of the most recent\n          <strong>broadcast notification dispatch</strong>.\n        </p>\n      </td>\n    </tr>\n\n    <!-- SUMMARY TABLE -->\n    <tr>\n      <td style=\"padding:0 22px 22px;\">\n        <table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" style=\"border-collapse:collapse; font-size:14px;\">\n          <tr style=\"background:#f8fafc;\">\n            <td width=\"65%\" style=\"border:1px solid #e5e7eb;\"><strong>Emails Successfully Sent</strong></td>\n            <td style=\"border:1px solid #e5e7eb; text-align:right;\">\n              {{ $json.adminReport.summary.sentCount }}\n            </td>\n          </tr>\n          <tr style=\"background:#fff7ed;\">\n            <td style=\"border:1px solid #e5e7eb;\"><strong>Records Skipped (Email Missing)</strong></td>\n            <td style=\"border:1px solid #e5e7eb; text-align:right;\">\n              {{ $json.adminReport.summary.missingCount }}\n            </td>\n          </tr>\n        </table>\n      </td>\n    </tr>\n\n    <!-- SENT RECORDS -->\n    <tr>\n      <td style=\"padding:0 22px;\">\n        <h3 style=\"margin:22px 0 8px; font-size:16px; border-bottom:1px solid #e5e7eb; padding-bottom:6px;\">\n          Successfully Dispatched Records\n        </h3>\n        <p style=\"margin:0 0 10px; font-size:13px; color:#374151;\">\n          The following records were processed and delivered successfully.\n        </p>\n        <pre style=\"background:#f1f5f9; padding:12px; font-size:12px; line-height:1.6; overflow:auto; border-radius:6px;\">\n```\n\n{{ JSON.stringify($json.adminReport.sent, null, 2) }} </pre> </td> </tr>\n\n```\n    <!-- MISSING RECORDS -->\n    <tr>\n      <td style=\"padding:0 22px;\">\n        <h3 style=\"margin:26px 0 8px; font-size:16px; border-bottom:1px solid #e5e7eb; padding-bottom:6px; color:#7c2d12;\">\n          Skipped Records ‚Äî Email Missing\n        </h3>\n        <p style=\"margin:0 0 10px; font-size:13px; color:#7c2d12;\">\n          These records were excluded due to missing or invalid email information.\n        </p>\n        <pre style=\"background:#fff7ed; padding:12px; font-size:12px; line-height:1.6; overflow:auto; border-radius:6px;\">\n```\n\n{{ $json.adminReport }}</pre> </td> </tr>\n\n```\n    <!-- FOOTER -->\n    <tr>\n      <td style=\"padding:18px 22px; background:#f8fafc; font-size:11px; color:#6b7280;\">\n        This report was generated automatically by the <strong>EDUVŒõULT ECOSYSTEM</strong>.<br>\n        No manual action is required for successfully dispatched records. Missing email records may be reviewed and corrected before reprocessing.\n      </td>\n    </tr>\n\n  </table>\n</td>\n```\n\n  </tr>\n</table>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        3776,
        6384
      ],
      "id": "6e21e415-1ce9-4941-8bc1-f6efef50b139",
      "name": "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Admin ‚ñ∏ Parents Dispatch Report",
      "webhookId": "3cafe13d-b8f7-489d-bd63-714336fd5d23",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "kingofpak111@gmail.com",
        "subject": "EDUVŒõULT ECOSYSTEM | Broadcast Dispatch Summary Report",
        "message": "=<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; background:#f1f5f9;\">   <tr>     <td align=\"center\" style=\"padding:26px 0;\">       <table width=\"720\" cellpadding=\"0\" cellspacing=\"0\" style=\"background:#ffffff; border-radius:8px; overflow:hidden; box-shadow:0 2px 8px rgba(0,0,0,0.06);\">  ```     <!-- HEADER -->     <tr>       <td style=\"padding:22px; background:#0f172a; color:#ffffff;\">         <div style=\"font-size:20px; font-weight:700; letter-spacing:0.4px;\">           EDUVŒõULT ECOSYSTEM         </div>         <div style=\"font-size:12px; color:#cbd5e1; margin-top:4px;\">           Broadcast Dispatch ‚Äî Administrative Report         </div>       </td>     </tr>      <!-- INTRO -->     <tr>       <td style=\"padding:22px; color:#111827;\">         <p style=\"margin:0; font-size:14px; line-height:1.7;\">           This is an automated administrative report summarizing the outcome of the most recent           <strong>broadcast notification dispatch</strong>.         </p>       </td>     </tr>      <!-- SUMMARY TABLE -->     <tr>       <td style=\"padding:0 22px 22px;\">         <table width=\"100%\" cellpadding=\"10\" cellspacing=\"0\" style=\"border-collapse:collapse; font-size:14px;\">           <tr style=\"background:#f8fafc;\">             <td width=\"65%\" style=\"border:1px solid #e5e7eb;\"><strong>Emails Successfully Sent</strong></td>             <td style=\"border:1px solid #e5e7eb; text-align:right;\">               {{ $json.adminReport.summary.sentCount }}             </td>           </tr>           <tr style=\"background:#fff7ed;\">             <td style=\"border:1px solid #e5e7eb;\"><strong>Records Skipped (Email Missing)</strong></td>             <td style=\"border:1px solid #e5e7eb; text-align:right;\">               {{ $json.adminReport.summary.missingCount }}             </td>           </tr>         </table>       </td>     </tr>      <!-- SENT RECORDS -->     <tr>       <td style=\"padding:0 22px;\">         <h3 style=\"margin:22px 0 8px; font-size:16px; border-bottom:1px solid #e5e7eb; padding-bottom:6px;\">           Successfully Dispatched Records         </h3>         <p style=\"margin:0 0 10px; font-size:13px; color:#374151;\">           The following records were processed and delivered successfully.         </p>         <pre style=\"background:#f1f5f9; padding:12px; font-size:12px; line-height:1.6; overflow:auto; border-radius:6px;\"> ```  {{ JSON.stringify($json.adminReport.sent, null, 2) }} </pre> </td> </tr>  ```     <!-- MISSING RECORDS -->     <tr>       <td style=\"padding:0 22px;\">         <h3 style=\"margin:26px 0 8px; font-size:16px; border-bottom:1px solid #e5e7eb; padding-bottom:6px; color:#7c2d12;\">           Skipped Records ‚Äî Email Missing         </h3>         <p style=\"margin:0 0 10px; font-size:13px; color:#7c2d12;\">           These records were excluded due to missing or invalid email information.         </p>         <pre style=\"background:#fff7ed; padding:12px; font-size:12px; line-height:1.6; overflow:auto; border-radius:6px;\"> ```  {{ JSON.stringify($json.adminReport.missing, null, 2) }} </pre> </td> </tr>  ```     <!-- FOOTER -->     <tr>       <td style=\"padding:18px 22px; background:#f8fafc; font-size:11px; color:#6b7280;\">         This report was generated automatically by the <strong>EDUVŒõULT ECOSYSTEM</strong>.<br>         No manual action is required for successfully dispatched records. Missing email records may be reviewed and corrected before reprocessing.       </td>     </tr>    </table> </td> ```    </tr> </table>",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        3904,
        6864
      ],
      "id": "34b9f478-e042-4d88-91ca-7ac3a3af7229",
      "name": "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Admin ‚ñ∏ Students Dispatch Report",
      "webhookId": "daeb65f2-557c-42ce-b24f-7cb6510361b9",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "height": 1136,
        "width": 4528,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        6016
      ],
      "typeVersion": 1,
      "id": "0c0ce1e3-7155-4555-8d31-668b4a4141bc",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "sendTo": "={{ $('Prepare_Ledger_Write_Payload').item.json.Parent_Email }}",
        "subject": "=EDUVAULT | Fee Recorded in Financial Ledger",
        "message": "=<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; border-collapse:collapse;\">\n\n  <!-- HEADER -->\n\n  <tr>\n    <td style=\"padding:16px; background:#0f172a; color:#ffffff;\">\n      <strong style=\"font-size:18px;\">EDUVAULT Financial Ledger</strong><br>\n      <span style=\"font-size:12px; color:#cbd5e1;\">\n        Automated ‚Ä¢ Auditable ‚Ä¢ Institution-Grade\n      </span>\n    </td>\n  </tr>\n\n  <!-- MAIN HIGHLIGHT / SYSTEM NOTICE -->\n\n  <tr>\n    <td style=\"padding:14px 18px; background:#f1f5f9; border-left:4px solid #2563eb;\">\n      <p style=\"margin:0; font-size:14px; color:#0f172a;\">\n        <strong>System Notice:</strong>\n        A fee transaction has been <strong>verified, committed, and permanently written</strong>\n        to the EDUVAULT Financial Ledger.\n      </p>\n    </td>\n  </tr>\n\n  <!-- BODY -->\n\n  <tr>\n    <td style=\"padding:18px; background:#ffffff;\">\n\n```\n  <!-- SUMMARY TABLE -->\n  <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\"\n    style=\"margin:8px 0 14px 0; font-size:13px; border-collapse:collapse;\">\n    <tr>\n      <td width=\"220\"><strong>Student Name</strong></td>\n      <td>{{ $('Prepare_Ledger_Write_Payload').item.json.Full_Name }}</td>\n    </tr>\n    <tr>\n      <td><strong>Galaxy ID</strong></td>\n      <td>{{ $('Merge').item.json.Galaxy_ID }}</td>\n    </tr>\n    <tr>\n      <td><strong>Class</strong></td>\n      <td>{{ $('Merge').item.json.Class }}</td>\n    </tr>\n    <tr>\n      <td><strong>Billing Month</strong></td>\n      <td>{{ $('Merge').item.json.Month_Label }}</td>\n    </tr>\n    <tr>\n      <td><strong>Amount Recorded</strong></td>\n      <td>PKR {{ $('Merge').item.json.Fee_Amount }}</td>\n    </tr>\n    <tr>\n      <td><strong>Receipt Reference</strong></td>\n      <td>{{ $('Merge').item.json.Receipt_ID }}</td>\n    </tr>\n    <tr>\n      <td><strong>Ledger Timestamp</strong></td>\n      <td>{{ $('Merge').item.json.Fee_Paid_At }}</td>\n    </tr>\n  </table>\n\n  <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:16px 0;\">\n\n  <!-- LEDGER EXPLANATION -->\n  <p style=\"font-size:13px; color:#374151;\">\n    The above entry has been written directly into the\n    <strong>class-specific financial ledger sheet</strong>.\n    No existing data was modified or overwritten during this operation.\n  </p>\n\n  <p style=\"font-size:13px; color:#374151; margin-top:10px;\">\n    EDUVAULT ledger entries are:\n  </p>\n\n  <ul style=\"font-size:13px; color:#374151; padding-left:18px;\">\n    <li>Immutable after write-commit</li>\n    <li>Time-stamped for audit traceability</li>\n    <li>Bound to a unique receipt reference</li>\n    <li>Maintained under controlled access</li>\n  </ul>\n\n  <p style=\"margin-top:14px; font-size:13px; color:#374151;\">\n    For reconciliation, verification, or compliance review,\n    reference the <strong>Receipt ID</strong> shown above.\n  </p>\n\n</td>\n```\n\n  </tr>\n\n  <!-- FOOTER -->\n\n  <tr>\n    <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">\n      This is an automated system notification generated by EDUVAULT.\n      Replies to this message are not monitored.\n    </td>\n  </tr>\n\n</table>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1296,
        1136
      ],
      "id": "6a2f8029-3f98-4c7d-afce-fd95dbf61cad",
      "name": "1.Gmail_Send_FEE_CONFIRMATION_Parent",
      "webhookId": "e944a276-db8b-4ea4-b5fd-0d55792a4de3",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "= {{ $('Prepare_Ledger_Write_Payload').item.json.Student_Email }}",
        "subject": "=EDUVAULT | Financial Ledger Update",
        "message": "=<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; border-collapse:collapse;\">\n\n  <!-- HEADER -->\n\n  <tr>\n    <td style=\"padding:16px; background:#0f172a; color:#ffffff;\">\n      <strong style=\"font-size:18px;\">EDUVAULT Financial Ledger</strong><br>\n      <span style=\"font-size:12px; color:#cbd5e1;\">\n        Automated ‚Ä¢ Auditable ‚Ä¢ Institution-Grade\n      </span>\n    </td>\n  </tr>\n\n  <!-- MAIN HIGHLIGHT / SYSTEM NOTICE -->\n\n  <tr>\n    <td style=\"padding:14px 18px; background:#f1f5f9; border-left:4px solid #2563eb;\">\n      <p style=\"margin:0; font-size:14px; color:#0f172a;\">\n        <strong>System Notice:</strong>\n        A fee transaction has been <strong>verified, committed, and permanently written</strong>\n        to the EDUVAULT Financial Ledger.\n      </p>\n    </td>\n  </tr>\n\n  <!-- BODY -->\n\n  <tr>\n    <td style=\"padding:18px; background:#ffffff;\">\n\n```\n  <!-- SUMMARY TABLE -->\n  <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\"\n    style=\"margin:8px 0 14px 0; font-size:13px; border-collapse:collapse;\">\n    <tr>\n      <td width=\"220\"><strong>Student Name</strong></td>\n      <td>{{ $('Prepare_Ledger_Write_Payload').item.json.Full_Name }}</td>\n    </tr>\n    <tr>\n      <td><strong>Galaxy ID</strong></td>\n      <td>{{ $('Merge').item.json.Galaxy_ID }}</td>\n    </tr>\n    <tr>\n      <td><strong>Class</strong></td>\n      <td>{{ $('Merge').item.json.Class }}</td>\n    </tr>\n    <tr>\n      <td><strong>Billing Month</strong></td>\n      <td>{{ $('Merge').item.json.Month_Label }}</td>\n    </tr>\n    <tr>\n      <td><strong>Amount Recorded</strong></td>\n      <td>PKR {{ $('Merge').item.json.Fee_Amount }}</td>\n    </tr>\n    <tr>\n      <td><strong>Receipt Reference</strong></td>\n      <td>{{ $('Merge').item.json.Receipt_ID }}</td>\n    </tr>\n    <tr>\n      <td><strong>Ledger Timestamp</strong></td>\n      <td>{{ $('Merge').item.json.Fee_Paid_At }}</td>\n    </tr>\n  </table>\n\n  <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:16px 0;\">\n\n  <!-- LEDGER EXPLANATION -->\n  <p style=\"font-size:13px; color:#374151;\">\n    The above entry has been written directly into the\n    <strong>class-specific financial ledger sheet</strong>.\n    No existing data was modified or overwritten during this operation.\n  </p>\n\n  <p style=\"font-size:13px; color:#374151; margin-top:10px;\">\n    EDUVAULT ledger entries are:\n  </p>\n\n  <ul style=\"font-size:13px; color:#374151; padding-left:18px;\">\n    <li>Immutable after write-commit</li>\n    <li>Time-stamped for audit traceability</li>\n    <li>Bound to a unique receipt reference</li>\n    <li>Maintained under controlled access</li>\n  </ul>\n\n  <p style=\"margin-top:14px; font-size:13px; color:#374151;\">\n    For reconciliation, verification, or compliance review,\n    reference the <strong>Receipt ID</strong> shown above.\n  </p>\n\n</td>\n```\n\n  </tr>\n\n  <!-- FOOTER -->\n\n  <tr>\n    <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">\n      This is an automated system notification generated by EDUVAULT.\n      Replies to this message are not monitored.\n    </td>\n  </tr>\n\n</table>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1296,
        1424
      ],
      "id": "fdd64666-c147-44f6-867d-f9a55fdd0eba",
      "name": "1.2.Gmail_Send_FEE_CONFIRMATION_Student",
      "webhookId": "8942855f-7b29-4a87-af93-c6665c89fdcf",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// Input\nconst f = $json;\n\n// ===== VALIDATIONS =====\nif (!f.Galaxy_ID) throw new Error(\"Missing Galaxy_ID\");\nif (f.Fee_Amount === undefined || f.Fee_Amount === null) {\n  throw new Error(\"Missing Fee_Amount\");\n}\n\n// ===== CLASS EXTRACTION =====\n// Expected: S-AA25-03-01-mn\nlet classNumber;\nconst m = f.Galaxy_ID.match(/S-[A-Z]{2}\\d{2}-(\\d{1,2})-\\d{2}-mn/i);\nif (m && m[1]) {\n  classNumber = m[1].padStart(2, '0');\n} else {\n  const parts = f.Galaxy_ID.split(\"-\");\n  classNumber = parts[2] ? parts[2].padStart(2, '0') : \"01\";\n}\nconst Class_Sheet = `Class_${classNumber}`;\n\n// ===== MONTH RESOLUTION (SAFE) =====\nlet Month_Label;\n\nif (f.Month_Label) {\n  // ‚úÖ Preferred (explicit)\n  Month_Label = f.Month_Label;\n} else if (f.submittedAt) {\n  // ‚ö†Ô∏è Controlled fallback (ISO timestamp)\n  const d = new Date(f.submittedAt);\n  const months = [\n    \"January\",\"February\",\"March\",\"April\",\"May\",\"June\",\n    \"July\",\"August\",\"September\",\"October\",\"November\",\"December\"\n  ];\n  Month_Label = `${months[d.getMonth()]} ${d.getFullYear()}`;\n} else {\n  throw new Error(\"Missing Month_Label and submittedAt\");\n}\n\n// ===== Fee_Paid_At (SERVER TIME) =====\nfunction formatPaidAt(d) {\n  const yyyy = d.getFullYear();\n  const mm = String(d.getMonth() + 1).padStart(2, '0');\n  const dd = String(d.getDate()).padStart(2, '0');\n  let hr = d.getHours();\n  const min = String(d.getMinutes()).padStart(2, '0');\n  const ampm = hr >= 12 ? 'PM' : 'AM';\n  hr = hr % 12;\n  if (hr === 0) hr = 12;\n  return `${yyyy}-${mm}-${dd} ${String(hr).padStart(2, '0')}:${min} ${ampm}`;\n}\n\nconst Fee_Paid_At = formatPaidAt(new Date());\n\n// ===== OUTPUT =====\nreturn {\n  json: {\n    Galaxy_ID: f.Galaxy_ID,\n\n    // Email / reference context\n    Full_Name: f.Full_Name,\n    Class: f.Class,\n    Parent_Email: f.Parent_Email,\n    Student_Email: f.Student_Email,\n\n    // Transaction core\n    Fee_Amount: Number(f.Fee_Amount),\n    Class_Sheet,\n    Month_Label,\n    Fee_Paid_At\n  }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        320,
        1456
      ],
      "id": "868cf127-2ff6-496f-a6c4-0bc490db8b46",
      "name": "Forge_Fee_Transaction_Payload1"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const f = $json;\n\n// Month_Label = \"January 2026\"\nconst [monthName, year] = f.Month_Label.split(\" \");\nconst monthShort = monthName.substring(0, 3);\n\n// Column key\nconst Month_Key = `${monthShort}_${year}`;\n\n// Full value to be written in cell\nconst Month_Full_Value = `${monthName} ${year}`;\n\nreturn {\n  json: {\n    action: \"FETCH_STUDENT_FEE_DATA\",\n\n    Galaxy_ID: f.Galaxy_ID,\n    Class_Sheet: f.Class_Sheet,\n\n    Month_Key,\n    Month_Full_Value,\n\n    Month_Columns: {\n      main: Month_Key,\n      fee: `${Month_Key}_Fee`,\n      status: `${Month_Key}_Status`,\n      receipt: `${Month_Key}_Receipt`,\n      paidAt: `${Month_Key}_PaidAt`\n    }\n  }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        528,
        1456
      ],
      "id": "e8563754-1ee1-488d-b3be-bfc0d5db9ae9",
      "name": "Prepare_Fee_Fetch_Payload"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "=https://script.google.com/macros/s/AKfycbyPCxM86qL0MRpwnnjr299An_aX0CpWtIWdbPmLZv2LyxtDKNYYxbl0Ydz0dCuYOkrg/exec",
        "sendHeaders": true,
        "specifyHeaders": "json",
        "jsonHeaders": "{\n  \"Content-Type\": \"application/json\"\n}\n",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"secret\": \"DUMMY_SECRET_KEY\",\n  \"action\": \"FETCH_STUDENT_FEE_DATA\",\n  \"Galaxy_ID\": \"{{ $json.Galaxy_ID }}\",\n  \"Class_Sheet\": \"{{ $json.Class_Sheet }}\",\n  \"Month_Key\": \"{{ $json.Month_Key }}\",\n  \"Month_Columns\": {{ JSON.stringify($json.Month_Columns) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        784,
        1456
      ],
      "id": "de5442e3-32fc-4050-aa1e-af760699c8af",
      "name": "HTTP_Fetch_Fee_Data"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "a79bfeff-062c-4c78-ac9d-2d7f6553959f",
              "leftValue": "={{ $json.ok }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        992,
        1456
      ],
      "id": "741af0b3-0bd8-4112-a784-d1a8ddb6be9b",
      "name": "IF_Fee_Eligibility_OK"
    },
    {
      "parameters": {
        "jsCode": "// Receipt format: RF-YY-MM-RANDOM\nconst now = new Date();\nconst yy = String(now.getFullYear()).slice(-2);\nconst mm = String(now.getMonth() + 1).padStart(2, '0');\nconst rand = Math.floor(1000 + Math.random() * 9000);\n\nconst Receipt_ID = `RF-${yy}-${mm}-${rand}`;\n\nreturn {\n  json: {\n    ...$json,\n    Receipt_ID,\n    Paid_At: now.toISOString()\n  }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        80,
        1280
      ],
      "id": "3f39f5ff-6b93-4586-a5f3-8f59a4e3f641",
      "name": "Generate_Receipt_ID"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "// Month_Columns se base month key nikaalna (Dec_2026 / Jan_2026 etc)\nconst monthKey = Object.keys($json.Month_Columns)\n  .find(k =>\n    !k.endsWith('_Fee') &&\n    !k.endsWith('_Status') &&\n    !k.endsWith('_Receipt') &&\n    !k.endsWith('_PaidAt')\n  );\n\nif (!monthKey) {\n  throw new Error(\"Month base column not found\");\n}\n\n// Full month value (e.g. \"December 2026\")\nconst monthFullValue = $json.Month_Label;\n\n// Class sheet already merged (Class_06 etc)\nconst classSheet = $json.Class_Sheet;\n\nreturn {\n  json: {\n    action: \"WRITE_FEE_LEDGER\",\n    row_number: $json.row_number,\n    Class_Sheet: classSheet,\n\n    update: {\n      // ‚úÖ MAIN month column (THIS WAS MISSING)\n      [monthKey]: monthFullValue,\n\n      // ‚úÖ Fee amount\n      [`${monthKey}_Fee`]: Number($json.Fee_Amount),\n\n      // ‚úÖ Status\n      [`${monthKey}_Status`]: \"PAID\",\n\n      // ‚úÖ Receipt\n      [`${monthKey}_Receipt`]: $json.Receipt_ID,\n\n      // ‚úÖ PaidAt (selected time)\n      [`${monthKey}_PaidAt`]: $json.Fee_Paid_At\n    },\n\n    // reference fields\n    Galaxy_ID: $json.Galaxy_ID,\n    Full_Name: $json.Full_Name,\n    Parent_Email: $json.Parent_Email,\n    Student_Email: $json.Student_Email\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        784,
        1296
      ],
      "id": "0cea8ee8-fe20-4bde-8d09-2bd945237443",
      "name": "Prepare_Ledger_Write_Payload"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://script.google.com/macros/s/AKfycbxbaRMe55RcL6kI_8GZObJ3cRSNEIElDTKEy3XcvUKyHE9FlfMjaRJuL_ZX26BUZYMS/exec",
        "sendHeaders": true,
        "specifyHeaders": "json",
        "jsonHeaders": "{\n  \"Content-Type\": \"application/json\"\n}\n",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"SECRET_KEY\": \"REPLACE_WITH_YOUR_SECRET\",\n  \"action\": \"WRITE_FEE_LEDGER\",\n  \"Class_Sheet\": \"{{ $json.Class_Sheet }}\",\n  \"row_number\": {{ $json.row_number }},\n  \"update\": {{ JSON.stringify($json.update) }}\n}\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        992,
        1296
      ],
      "id": "3684cfc6-0cf5-48da-8d38-f09d83878c65",
      "name": "HTTP_Write_Fee_Ledger"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        320,
        1296
      ],
      "id": "18e677df-bcf2-4873-a71e-e710b275cc52",
      "name": "Merge"
    },
    {
      "parameters": {
        "jsCode": "const d = new Date();\n\nconst monthNames = [\"Jan\",\"Feb\",\"Mar\",\"Apr\",\"May\",\"Jun\",\"Jul\",\"Aug\",\"Sep\",\"Oct\",\"Nov\",\"Dec\"];\n\nconst label = `${monthNames[d.getMonth()]}_${d.getFullYear()}`;\n\nreturn [\n  {\n    json: {\n      Month_Label: label\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        320,
        1904
      ],
      "id": "cb9a695e-f39d-48f7-ab17-8287eb713607",
      "name": "Prepare Month Label1"
    },
    {
      "parameters": {
        "jsCode": "const classes = [];\n\nfor (let i = 1; i <= 12; i++) {\n  classes.push({\n    Class_Sheet: `Class_${String(i).padStart(2, \"0\")}`\n  });\n}\n\nreturn classes.map(c => ({ json: c }));"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        320,
        1712
      ],
      "id": "16466f4f-e811-437e-912b-293d818bca3e",
      "name": "Forge_Class_Execution_Context1"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "field": "months",
              "triggerAtHour": 2,
              "triggerAtMinute": 10
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.2,
      "position": [
        80,
        1808
      ],
      "id": "c6091fd5-3be7-46b1-b6ba-ed357d62355c",
      "name": "Temporal_Execution_Trigger1"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineAll",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        608,
        1808
      ],
      "id": "b6ed6e7d-42c0-4e92-99a2-3538f111b233",
      "name": "Unified_Context_Convergence_Core1"
    },
    {
      "parameters": {
        "mode": "runOnceForEachItem",
        "jsCode": "const month = $json.Month_Label;\n\nreturn {\n  json: {\n    Class_Sheet: $json.Class_Sheet,\n    Col_Main: month,\n    Col_Fee: `${month}_Fee`,\n    Col_Status: `${month}_Status`,\n    Col_Receipt: `${month}_Receipt`,\n    Col_PaidAt: `${month}_PaidAt`,\n\n  }\n};\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        848,
        1808
      ],
      "id": "7c5421e1-9058-4a01-9028-fabd526c1160",
      "name": "Column_Namespace_Compiler2"
    },
    {
      "parameters": {
        "url": "=https://script.google.com/macros/s/AKfycbz59Vx73nhm9fnUkk01tAKzutmeFRu_komggdKUtpf0w3ZN43C-Zm1wx1XL4KBWXvJ9/exec\n?action=createColumns\n&class={{$json.Class_Sheet}}\n&main={{$json.Col_Main}}\n&fee={{$json.Col_Fee}}\n&status={{$json.Col_Status}}\n&receipt={{$json.Col_Receipt}}\n&paidAt={{$json.Col_PaidAt}}\n&secret=LO737AIRLINESMNXmnxMNXmnx\n",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1088,
        1808
      ],
      "id": "b4fb2820-221b-4578-acb2-df629d6f47f7",
      "name": "Temporal_Clo_Schema_Injector1"
    },
    {
      "parameters": {
        "height": 992,
        "width": 1728,
        "color": 7
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        0,
        1120
      ],
      "typeVersion": 1,
      "id": "42aca9b7-0646-4dee-8058-a7ef689e9cf0",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "sendTo": "ai.ml.nauman@gmail.com",
        "subject": "=EDUVAULT | Monthly Defaulters Report ‚Äî {{ $json.month }} ",
        "message": "=<table width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"font-family:Arial,Helvetica,sans-serif; border-collapse:collapse;\">\n\n  <!-- HEADER -->\n\n  <tr>\n    <td style=\"padding:16px; background:#0f172a; color:#ffffff;\">\n      <strong style=\"font-size:18px;\">EDUVAULT Financial Operations</strong><br>\n      <span style=\"font-size:12px; color:#cbd5e1;\">\n        Automated Fee Monitoring & Compliance Reporting\n      </span>\n    </td>\n  </tr>\n\n  <!-- SYSTEM NOTICE -->\n\n  <tr>\n    <td style=\"padding:14px 18px; background:#f1f5f9; border-left:4px solid #dc2626;\">\n      <p style=\"margin:0; font-size:14px; color:#0f172a;\">\n        <strong>System Report:</strong>\n        The following summary reflects <strong>unpaid fee records</strong>\n        identified by the EDUVAULT Financial Ledger for the reporting period\n        <strong>{{ $json.month }}</strong>.\n      </p>\n    </td>\n  </tr>\n\n  <!-- BODY -->\n\n  <tr>\n    <td style=\"padding:18px; background:#ffffff;\">\n\n```\n  <!-- SUMMARY -->\n  <table width=\"100%\" cellpadding=\"6\" cellspacing=\"0\"\n    style=\"margin:8px 0 14px 0; font-size:13px; border-collapse:collapse;\">\n    <tr>\n      <td width=\"260\"><strong>Total Unpaid Students</strong></td>\n      <td><strong>{{ $json.unpaid_count }}</strong></td>\n    </tr>\n    <tr>\n      <td><strong>Total Pending Amount</strong></td>\n      <td><strong>PKR {{ $json.total_pending_amount }}</strong></td>\n    </tr>\n    <tr>\n      <td><strong>Reporting Month</strong></td>\n      <td>{{ $json.month }}</td>\n    </tr>\n  </table>\n\n  <hr style=\"border:none; border-top:1px solid #e5e7eb; margin:16px 0;\">\n\n  <!-- UNPAID LIST -->\n  <p style=\"font-size:14px; font-weight:bold; margin-bottom:8px; color:#111827;\">\n    Unpaid Students Snapshot\n  </p>\n\n  <table width=\"100%\" cellpadding=\"8\" cellspacing=\"0\" border=\"1\"\n    style=\"border-collapse:collapse; font-size:13px;\">\n    <tr style=\"background:#f1f5f9;\">\n      <th align=\"left\">#</th>\n      <th align=\"left\">Galaxy ID</th>\n      <th align=\"left\">Student Name</th>\n      <th align=\"left\">Monthly Fee</th>\n    </tr>\n\n    {{\n      $json.unpaid_students\n        .map((s, i) => `\n          <tr>\n            <td>${i + 1}</td>\n            <td>${s.Galaxy_ID}</td>\n            <td>${s.Full_Name}</td>\n            <td>PKR ${s.Monthly_Fee}</td>\n          </tr>\n        `)\n        .join('')\n    }}\n\n  </table>\n\n  <p style=\"margin-top:16px; font-size:13px; color:#374151;\">\n    This report is generated directly from the <strong>EDUVAULT Financial Ledger</strong>.\n    Only records marked as unpaid at the time of execution are included.\n    No manual filtering or modification has been applied.\n  </p>\n\n  <p style=\"margin-top:10px; font-size:13pxarn;\">\n    This report supports:\n  </p>\n\n  <ul style=\"font-size:13px; color:#374151; padding-left:18px;\">\n    <li>Fee follow-up and parent communication</li>\n    <li>Monthly financial reconciliation</li>\n    <li>Audit and compliance review</li>\n  </ul>\n\n</td>\n```\n\n  </tr>\n\n  <!-- FOOTER -->\n\n  <tr>\n    <td style=\"padding:14px; background:#f8fafc; font-size:11px; color:#6b7280;\">\n      This is an automated administrative report generated by EDUVAULT.\n      Please do not reply to this message.\n    </td>\n  </tr>\n\n</table>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1472,
        3232
      ],
      "id": "a4288245-9404-4d1a-89e4-9d0694b577d4",
      "name": "Gmail_Send_FINAL_Report_Admin",
      "webhookId": "6f9ef174-b318-40d8-b86b-5d754adca659",
      "credentials": {
        "gmailOAuth2": {
          "id": "O5avxoQpmu4LcnhY",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "authentication": "basicAuth",
        "formTitle": "¬© EDUVŒõULT ECOSYSTEM‚Ñ¢_ Student Status Management",
        "formDescription": "This form is part of the EDUVŒõULT ECOSYSTEM and is used to manage the active or inactive status of students.",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Galaxy_ID",
              "placeholder": "S-AA00-00-00-mn",
              "requiredField": true
            },
            {
              "fieldLabel": "Status",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Active"
                  },
                  {
                    "option": "Inactive"
                  }
                ]
              },
              "requiredField": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        1888,
        1312
      ],
      "id": "b07ea867-54fd-4a93-bcb2-88c436057c49",
      "name": "EDUVAULT‚ñ∏Authorized_Student_Lifecycle_State_Management_Portal",
      "webhookId": "088cbe52-9bf7-42c5-a2c3-21c9a04e6952",
      "credentials": {
        "httpBasicAuth": {
          "id": "3iOZRyG9o3vlMu1T",
          "name": "Unnamed credential"
        }
      }
    },
    {
      "parameters": {
        "authentication": "basicAuth",
        "formTitle": "¬© EDUVŒõULT ECOSYSTEM‚Ñ¢_ Institutional Broadcast Portal",
        "formDescription": "This portal is used to issue official institutional communications to students\nand parents through the EDUVŒõULT ECOSYSTEM.\n\nMessages submitted here may include announcements, holidays, exams, meetings,\nreminders, or emergency notices, and will be delivered according to the selected\naudience and class scope.\n\nAll broadcasts are system-logged, time-stamped, and governed under\ninstitutional communication protocols.",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Target_Audience",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Students"
                  },
                  {
                    "option": "Parents"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Class_Selection",
              "placeholder": "class 1.2.......12 OR all classes",
              "requiredField": true
            },
            {
              "fieldLabel": "Message_Type",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Announcement"
                  },
                  {
                    "option": "  Exam"
                  },
                  {
                    "option": "  Meeting"
                  },
                  {
                    "option": "  Reminder"
                  },
                  {
                    "option": "  Holiday"
                  },
                  {
                    "option": "  General"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Raw_Message",
              "placeholder": "Your_Term",
              "requiredField": true
            }
          ]
        },
        "options": {
          "respondWithOptions": {
            "values": {
              "formSubmittedText": "‚úî Broadcast Request Accepted\n\nYour submission has been securely recorded within the EDUVŒõULT ECOSYSTEM.\n\n|The message will now undergo automated validation and delivery to eligible recipients.Records with missing or invalid contact details will be excluded and reported to administrators.You may safely close this portal."
            }
          }
        }
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        80,
        6480
      ],
      "id": "52ecb98d-2aa0-4408-ba5f-362b5d155d6a",
      "name": "EDUVAULT‚ñ∏Admin_Broadcast_Command_Portal",
      "webhookId": "f2939b6b-743f-4496-94ab-5df3cdc957da",
      "credentials": {
        "httpBasicAuth": {
          "id": "3iOZRyG9o3vlMu1T",
          "name": "Unnamed credential"
        }
      }
    },
    {
      "parameters": {
        "authentication": "basicAuth",
        "formTitle": "¬© EDUVŒõULT ECOSYSTEM‚Ñ¢_ Attendance Management Portal",
        "formDescription": "This portal is used to securely record and manage student attendance within the EDUVŒõULT ECOSYSTEM.\n\nAll submissions are validated in real time and automatically synchronized with monthly reports, analytics, and administrative dashboards.\n\nInactive or invalid records are automatically excluded as per system policy.",
        "formFields": {
          "values": [
            {
              "fieldLabel": "class",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Class_01"
                  },
                  {
                    "option": "Class_02"
                  },
                  {
                    "option": "Class_03"
                  },
                  {
                    "option": "Class_04"
                  },
                  {
                    "option": "Class_05"
                  },
                  {
                    "option": "Class_06"
                  },
                  {
                    "option": "Class_07"
                  },
                  {
                    "option": "Class_08"
                  },
                  {
                    "option": "Class_09"
                  },
                  {
                    "option": "Class_10"
                  },
                  {
                    "option": "Class_11"
                  },
                  {
                    "option": "Class_12"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "‚úî ‚Üí P",
              "placeholder": "00,00,00............................"
            },
            {
              "fieldLabel": "‚úñ ‚Üí A",
              "placeholder": "00,00,00............................"
            },
            {
              "fieldLabel": "‚óê ‚Üí L",
              "placeholder": "00,00,00............................"
            }
          ]
        },
        "options": {
          "respondWithOptions": {
            "values": {
              "formSubmittedText": "‚úî Attendance Successfully Recorded  \n\nYour attendance submission has been securely saved in the EDUVŒõULT ECOSYSTEM.  \nThe records are now locked and reflected in:  \nMonthly attendance summaries  Student & parent reports  Administrative analytics dashboards  No further action is required at this time. \n\nYou may safely close this portal."
            }
          }
        }
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        1888,
        4272
      ],
      "id": "0ebdb46f-96ba-4a0d-8936-8ce0517d65dd",
      "name": "EDUVAULT‚ñ∏ Attendance_Submission_Interface_Portal",
      "webhookId": "c27d2d7a-a018-454c-ad73-60f818e5b88e",
      "credentials": {
        "httpBasicAuth": {
          "id": "3iOZRyG9o3vlMu1T",
          "name": "Unnamed credential"
        }
      }
    },
    {
      "parameters": {
        "authentication": "basicAuth",
        "formTitle": "EDUVŒõULT ‚Äî Student Fee Submission Portal",
        "formDescription": "Use this form to record a student's monthly fee payment. Please enter the student's Galaxy ID exactly as provided at admission, and the paid amount in PKR. The system will auto-detect the month, generate a receipt, update the fee sheet, and email a confirmation.",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Galaxy_ID",
              "placeholder": "S-AAXX-XX-XX-mn"
            },
            {
              "fieldLabel": "Fee_Amount",
              "fieldType": "number",
              "placeholder": "XXXX"
            }
          ]
        },
        "options": {
          "appendAttribution": false,
          "path": "cde53f46-9eac-4444-a7d9-a34bfb0ad82c",
          "respondWithOptions": {
            "values": {
              "formSubmittedText": "‚ÄúThank you! your payment has been received."
            }
          }
        }
      },
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        80,
        1456
      ],
      "id": "632dc779-ab78-46bf-9789-f5f32f72398b",
      "name": "EDUVAULT‚ñ∏Fee_Ingress_Gateway_Portal",
      "webhookId": "cde53f46-9eac-4444-a7d9-a34bfb0ad82c",
      "credentials": {
        "httpBasicAuth": {
          "id": "3iOZRyG9o3vlMu1T",
          "name": "Unnamed credential"
        }
      }
    },
    {
      "parameters": {
        "authentication": "basicAuth",
        "formTitle": "¬© EDUVŒõULT ECOSYSTEM‚Ñ¢ _ Genesis Portal",
        "formDescription": "Welcome to the official ¬© EDUVŒõULT ECOSYSTEM‚Ñ¢ Admission Portal.\n\nThis portal is used to securely capture student admission details for academic enrollment\nand institutional verification. All information submitted through this form becomes part of\nthe institution‚Äôs official academic record and is processed under controlled governance\nworkflows.\n\nPlease ensure that all details provided are accurate, complete, and verifiable, as\nsubmitted records are digitally time-stamped and audited by the system.\n",
        "formFields": {
          "values": [
            {
              "fieldLabel": "Full Name",
              "requiredField": true
            },
            {
              "fieldLabel": "Gender",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Boy"
                  },
                  {
                    "option": "Girl"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Date of Birth",
              "fieldType": "date",
              "requiredField": true
            },
            {
              "fieldLabel": "Class",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "01"
                  },
                  {
                    "option": "02"
                  },
                  {
                    "option": "03"
                  },
                  {
                    "option": "04"
                  },
                  {
                    "option": "05"
                  },
                  {
                    "option": "06"
                  },
                  {
                    "option": "07"
                  },
                  {
                    "option": "08"
                  },
                  {
                    "option": "09"
                  },
                  {
                    "option": "10"
                  },
                  {
                    "option": "11"
                  },
                  {
                    "option": "12"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Parent Type",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "Father"
                  },
                  {
                    "option": "Mother"
                  },
                  {
                    "option": "Guardian"
                  }
                ]
              },
              "requiredField": true
            },
            {
              "fieldLabel": "Parent Name",
              "requiredField": true
            },
            {
              "fieldLabel": "Student Email",
              "fieldType": "email"
            },
            {
              "fieldLabel": "Parent Email",
              "fieldType": "email",
              "requiredField": true
            },
            {
              "fieldLabel": "Primary Phone",
              "requiredField": true
            },
            {
              "fieldLabel": "Secondary Phone"
            },
            {
              "fieldLabel": "Student CNIC"
            },
            {
              "fieldLabel": "Parent CNIC",
              "requiredField": true
            },
            {
              "fieldLabel": "Address",
              "fieldType": "textarea",
              "requiredField": true
            },
            {
              "fieldLabel": "Admission Fee",
              "fieldType": "number",
              "requiredField": true
            },
            {
              "fieldLabel": "Monthly Fee",
              "fieldType": "number",
              "requiredField": true
            },
            {
              "fieldLabel": "Scholarship %",
              "fieldType": "dropdown",
              "fieldOptions": {
                "values": [
                  {
                    "option": "None"
                  },
                  {
                    "option": "25"
                  },
                  {
                    "option": "50"
                  },
                  {
                    "option": "75"
                  },
                  {
                    "option": "100"
                  }
                ]
              }
            }
          ]
        },
        "options": {
          "appendAttribution": false,
          "path": "52763c49-ae4a-4a7d-9b25-30478e2b4933",
          "respondWithOptions": {
            "values": {
              "formSubmittedText": "Thank you! You are now part of the EDUVŒõULT Genesis Network."
            }
          }
        }
      },
      "id": "74a5b163-28b8-43ba-aa42-3a2a4859bebc",
      "name": "EDUVAULT‚ñ∏Galaxy_Identity_Intake_Portal",
      "type": "n8n-nodes-base.formTrigger",
      "typeVersion": 2.3,
      "position": [
        96,
        448
      ],
      "webhookId": "52763c49-ae4a-4a7d-9b25-30478e2b4933",
      "credentials": {
        "httpBasicAuth": {
          "id": "3iOZRyG9o3vlMu1T",
          "name": "Unnamed credential"
        }
      }
    },
    {
      "parameters": {
        "operation": "send",
        "phoneNumberId": "=1005494022636232",
        "recipientPhoneNumber": "923164586882",
        "textBody": "=üì≤ EDUVŒõULT OS‚Ñ¢ ‚Äî WhatsApp Fee Reminder (Parent / Guardian)\n\nEDUVŒõULT OS‚Ñ¢\nAcademic & Financial Operations\n\nüîî Fee Payment Reminder ‚Äî {{ $json.Month }}\n\nThis is an official reminder regarding the monthly fee for the following student, which is currently marked as UNPAID in our system.\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüë§ Student Name: {{ $json.Full_Name }}\nüè∑Ô∏è Galaxy ID: {{ $json.Galaxy_ID }}\nüè´ Class: {{ $json.Class }}\nüí∞ Monthly Fee: Rs {{ $json.Monthly_Fee }}\nüìÖ Billing Month: {{ $json.Month }}\nüìå Status: UNPAID\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n\n‚ö†Ô∏è Please note: Continued non-payment may result in temporary restriction of academic services, as per institutional policy.\n\nüëâ Pay Fee Now:\n{{ $json.payment_link }}\n\nIf payment has already been made, kindly ignore this message.\n\n‚Äî\nEDUVŒõULT OS‚Ñ¢ Management\nAutomated Academic & Financial Intelligence",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.whatsApp",
      "typeVersion": 1.1,
      "position": [
        1184,
        3376
      ],
      "id": "db37002b-8d7f-422c-995d-3731d8553d4e",
      "name": "Send message2",
      "webhookId": "2ae5e999-6a27-459c-bd43-d3ce74708201",
      "credentials": {
        "whatsAppApi": {
          "id": "NsvOZLQGZPOgINcr",
          "name": "WhatsApp account 3"
        }
      }
    }
  ],
  "pinData": {
    "CODE ‚ñ∏ Attendance Batch Builder": [
      {
        "json": {
          "action": "batchAttendanceWrite",
          "class": "Class_12",
          "attendance_column": "A_Dec25_27",
          "writes": [
            {
              "galaxy_id": "S-AA25-12-02-mn",
              "row": 3,
              "column": "A_Dec25_27",
              "value": "‚úî"
            },
            {
              "galaxy_id": "S-AA25-12-01-mn",
              "row": 2,
              "column": "A_Dec25_27",
              "value": "‚úñ"
            }
          ]
        }
      }
    ],
    "MERGE ‚ñ∏ Success Attendance Context": [
      {
        "json": {
          "ok": true,
          "message": "Attendance written",
          "written": 2,
          "action": "batchAttendanceWrite",
          "class": "Class_12",
          "attendance_column": "A_Dec25_27",
          "writes": [
            {
              "galaxy_id": "S-AA25-12-02-mn",
              "row": 3,
              "column": "A_Dec25_27",
              "value": "‚úî"
            },
            {
              "galaxy_id": "S-AA25-12-01-mn",
              "row": 2,
              "column": "A_Dec25_27",
              "value": "‚úñ"
            }
          ]
        }
      }
    ],
    "MERGE ‚ñ∏ Failed Attendance Context": [
      {
        "json": {
          "ok": false,
          "message": "Unauthorized",
          "action": "batchAttendanceWrite",
          "class": "Class_12",
          "attendance_column": "A_Dec25_27",
          "writes": [
            {
              "galaxy_id": "S-AA25-12-02-mn",
              "row": 3,
              "column": "A_Dec25_27",
              "value": "‚úî"
            },
            {
              "galaxy_id": "S-AA25-12-01-mn",
              "row": 2,
              "column": "A_Dec25_27",
              "value": "‚úñ"
            }
          ]
        }
      }
    ],
    "Normalize_Broadcast_Command": [
      {
        "json": {
          "targetAudience": "Students",
          "messageType": "  Holiday",
          "polishedMessage": "The campus will be closed tomorrow.",
          "classes": [
            "Class_01",
            "Class_02",
            "Class_03",
            "Class_04",
            "Class_05",
            "Class_06",
            "Class_07",
            "Class_08",
            "Class_09",
            "Class_10",
            "Class_11",
            "Class_12"
          ],
          "submittedAt": "2025-12-30T02:06:16.906-05:00",
          "source": "EDUVAULT_BROADCAST_SYSTEM"
        }
      }
    ],
    "HTTP_Fetch_Class_Student_Registry": [
      {
        "json": {
          "ok": true,
          "class": "Class_01",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-01-01-mn",
              "Full_Name": "Berlin Rio",
              "Student_Email": "",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-01-02-mn",
              "Full_Name": "Ayesha Eman",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_02",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-02-01-mn",
              "Full_Name": "Rose",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-02-02-mn",
              "Full_Name": "Tatiana Tatiana",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_03",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-03-01-mn",
              "Full_Name": "Tenzay Norgay",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-03-02-mn",
              "Full_Name": "Ziqii",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman.@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_04",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-04-01-mn",
              "Full_Name": "Monica Gaztambide",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-04-02-mn",
              "Full_Name": "Sicer Gandia",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_05",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-05-01-mn",
              "Full_Name": "Charlis Babbage",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-05-02-mn",
              "Full_Name": "Rio Rio",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_06",
          "totalActiveStudents": 6,
          "students": [
            {
              "Galaxy_ID": "S-AA25-06-01-mn",
              "Full_Name": "Yashfa Noor",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-06-03-mn",
              "Full_Name": "Bogota Bagota",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-06-04-mn",
              "Full_Name": "Tokyo Tokyo",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-06-06-mn",
              "Full_Name": "Tatiana",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-06-07-mn",
              "Full_Name": "Tatiana",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-06-08-mn",
              "Full_Name": "Tatiana",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_07",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-07-01-mn",
              "Full_Name": "lilli ilen",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-07-02-mn",
              "Full_Name": "Matias Cano",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_08",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-08-01-mn",
              "Full_Name": "Monica Gustambedi",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-08-02-mn",
              "Full_Name": "Oslo Oslo",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_09",
          "totalActiveStudents": 1,
          "students": [
            {
              "Galaxy_ID": "S-AA25-09-01-mn",
              "Full_Name": "Rio Rio",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_10",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-10-01-mn",
              "Full_Name": "Sugasta Sugasta",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-10-02-mn",
              "Full_Name": "Raquel Murillo",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_11",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-11-01-mn",
              "Full_Name": "Siceer Gandia",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-11-02-mn",
              "Full_Name": "Alison Parker",
              "Student_Email": "",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            }
          ]
        }
      },
      {
        "json": {
          "ok": true,
          "class": "Class_12",
          "totalActiveStudents": 2,
          "students": [
            {
              "Galaxy_ID": "S-AA25-12-01-mn",
              "Full_Name": "Berlin Berlin",
              "Student_Email": "",
              "Parent_Email": "ai.ml.nauman@gmail.com"
            },
            {
              "Galaxy_ID": "S-AA25-12-02-mn",
              "Full_Name": "Berlin Berlin",
              "Student_Email": "kingofpak111@gmail.com",
              "Parent_Email": ""
            }
          ]
        }
      }
    ],
    "Code_Students_Detect_Send_Or_Missing": [
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_01",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-01-01-mn",
              "Full_Name": "Berlin Rio",
              "Student_Email": ""
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "MISSING",
          "missingReason": "STUDENT_EMAIL_MISSING",
          "missingEmailFor": "Students",
          "missingGalaxyID": "S-AA25-01-01-mn"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_01",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-01-02-mn",
              "Full_Name": "Ayesha Eman",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_02",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-02-01-mn",
              "Full_Name": "Rose",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_02",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-02-02-mn",
              "Full_Name": "Tatiana Tatiana",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_03",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-03-01-mn",
              "Full_Name": "Tenzay Norgay",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_03",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-03-02-mn",
              "Full_Name": "Ziqii",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_04",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-04-01-mn",
              "Full_Name": "Monica Gaztambide",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_04",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-04-02-mn",
              "Full_Name": "Sicer Gandia",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_05",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-05-01-mn",
              "Full_Name": "Charlis Babbage",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_05",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-05-02-mn",
              "Full_Name": "Rio Rio",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_06",
            "totalActiveStudents": 6,
            "students": {
              "Galaxy_ID": "S-AA25-06-01-mn",
              "Full_Name": "Yashfa Noor",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_06",
            "totalActiveStudents": 6,
            "students": {
              "Galaxy_ID": "S-AA25-06-03-mn",
              "Full_Name": "Bogota Bagota",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_06",
            "totalActiveStudents": 6,
            "students": {
              "Galaxy_ID": "S-AA25-06-04-mn",
              "Full_Name": "Tokyo Tokyo",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_06",
            "totalActiveStudents": 6,
            "students": {
              "Galaxy_ID": "S-AA25-06-06-mn",
              "Full_Name": "Tatiana",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_06",
            "totalActiveStudents": 6,
            "students": {
              "Galaxy_ID": "S-AA25-06-07-mn",
              "Full_Name": "Tatiana",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_06",
            "totalActiveStudents": 6,
            "students": {
              "Galaxy_ID": "S-AA25-06-08-mn",
              "Full_Name": "Tatiana",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_07",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-07-01-mn",
              "Full_Name": "lilli ilen",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_07",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-07-02-mn",
              "Full_Name": "Matias Cano",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_08",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-08-01-mn",
              "Full_Name": "Monica Gustambedi",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_08",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-08-02-mn",
              "Full_Name": "Oslo Oslo",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_09",
            "totalActiveStudents": 1,
            "students": {
              "Galaxy_ID": "S-AA25-09-01-mn",
              "Full_Name": "Rio Rio",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_10",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-10-01-mn",
              "Full_Name": "Sugasta Sugasta",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_10",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-10-02-mn",
              "Full_Name": "Raquel Murillo",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_11",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-11-01-mn",
              "Full_Name": "Siceer Gandia",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_11",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-11-02-mn",
              "Full_Name": "Alison Parker",
              "Student_Email": ""
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "MISSING",
          "missingReason": "STUDENT_EMAIL_MISSING",
          "missingEmailFor": "Students",
          "missingGalaxyID": "S-AA25-11-02-mn"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_12",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-12-01-mn",
              "Full_Name": "Berlin Berlin",
              "Student_Email": ""
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "MISSING",
          "missingReason": "STUDENT_EMAIL_MISSING",
          "missingEmailFor": "Students",
          "missingGalaxyID": "S-AA25-12-01-mn"
        }
      },
      {
        "json": {
          "targetAudience": "Students",
          "payload": {
            "ok": true,
            "class": "Class_12",
            "totalActiveStudents": 2,
            "students": {
              "Galaxy_ID": "S-AA25-12-02-mn",
              "Full_Name": "Berlin Berlin",
              "Student_Email": "kingofpak111@gmail.com"
            },
            "targetAudience": "Students",
            "messageType": "  Holiday",
            "polishedMessage": "The campus will be closed tomorrow.",
            "submittedAt": "2025-12-30T02:06:16.906-05:00",
            "source": "EDUVAULT_BROADCAST_SYSTEM"
          },
          "mode": "SEND"
        }
      }
    ],
    "EDUVAULT‚ñ∏Admin_Broadcast_Command_Portal": [
      {
        "json": {
          "Target_Audience": "Parents",
          "Class_Selection": "all classes",
          "Message_Type": "  Holiday",
          "Raw_Message": "kal campus band rhe ga",
          "submittedAt": "2025-12-30T02:06:16.906-05:00",
          "formMode": "test"
        }
      }
    ],
    "EDUVAULT‚ñ∏ Attendance_Submission_Interface_Portal": [
      {
        "json": {
          "class": "Class_12",
          "‚úî ‚Üí P": "02",
          "‚úñ ‚Üí A": "01",
          "‚óê ‚Üí L": "",
          "submittedAt": "2025-12-27T16:54:07.148+05:00",
          "formMode": "test"
        }
      }
    ],
    "EDUVAULT‚ñ∏Fee_Ingress_Gateway_Portal": [
      {
        "json": {
          "Galaxy_ID": "S-AA25-06-01-mn",
          "Fee_Amount": 4000,
          "submittedAt": "2026-01-15T12:37:45.913-05:00",
          "formMode": "test"
        }
      }
    ],
    "Code in JavaScript": [
      {
        "json": {
          "action": "fetchMonthlyStudentData",
          "monthCode": "Dec25",
          "monthName": "December",
          "year": 2025,
          "attendancePrefix": "A_Dec25_",
          "summary": {
            "executedAt": "2025-12-31T09:53:04.925+05:00",
            "timezone": "Asia/Karachi (UTC+05:00)"
          }
        }
      }
    ]
  },
  "connections": {
    "Generate Class List": {
      "main": [
        [
          {
            "node": "Fetch_Unpaid_Students_By_Class_And_Month",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch_Unpaid_Students_By_Class_And_Month": {
      "main": [
        [
          {
            "node": "Route_By_Reminder_Type",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Medium Reminder": {
      "main": [
        [
          {
            "node": "Set Reminder Type ‚Äì MEDIUM",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Soft Reminder": {
      "main": [
        [
          {
            "node": "Set Reminder Type ‚Äì SOFT",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Strong Reminder": {
      "main": [
        [
          {
            "node": "Set Reminder Type ‚Äì STRONG",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Final + Report": {
      "main": [
        [
          {
            "node": "Set Reminder Type ‚Äì FINAL + REPORT",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Reminder Type ‚Äì SOFT": {
      "main": [
        [
          {
            "node": "Column_Namespace_Compiler1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Reminder Type ‚Äì MEDIUM": {
      "main": [
        [
          {
            "node": "Column_Namespace_Compiler1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Reminder Type ‚Äì STRONG": {
      "main": [
        [
          {
            "node": "Column_Namespace_Compiler1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Reminder Type ‚Äì FINAL + REPORT": {
      "main": [
        [
          {
            "node": "Column_Namespace_Compiler1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Route_By_Reminder_Type": {
      "main": [
        [
          {
            "node": "Split_Students_For_Email1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Split_Students_For_Email2",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Split_Students_For_Email3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Financial_Delinquency_Aggregator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split_Students_For_Email1": {
      "main": [
        [
          {
            "node": "Split_Students_For_Email1.1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split_Students_For_Email1.1": {
      "main": [
        [
          {
            "node": "Gmail_Send_SOFT_Reminder_Student",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gmail_Send_SOFT_Reminder_Parent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split_Students_For_Email2.1": {
      "main": [
        [
          {
            "node": "Gmail_Send_MEDIUM_Reminder_Parent",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gmail_Send_MEDIUM_Reminder_Student",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split_Students_For_Email3.1": {
      "main": [
        [
          {
            "node": "Gmail_Send_STRONG_Reminder_Parent",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gmail_Send_STRONG_Reminder_Student",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split_Students_For_Email2": {
      "main": [
        [
          {
            "node": "Split_Students_For_Email2.1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split_Students_For_Email3": {
      "main": [
        [
          {
            "node": "Split_Students_For_Email3.1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Replace Me3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me1": {
      "main": [
        [
          {
            "node": "Split_Students_For_Email1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me3": {
      "main": [
        [
          {
            "node": "Split_Students_For_Email3",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Replace Me2": {
      "main": [
        [
          {
            "node": "Split_Students_For_Email2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Email_Safety_Filter": {
      "main": [
        [
          {
            "node": "Gmail_Send_Invalid_Email_Report_Admin",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Normalize_Galaxy_Intake_Payload": {
      "main": [
        [
          {
            "node": "Assemble_Galaxy_Identity_Context",
            "type": "main",
            "index": 0
          },
          {
            "node": "Fetch_Galaxy_Identity_Sequence",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch_Galaxy_Identity_Sequence": {
      "main": [
        [
          {
            "node": "Assemble_Galaxy_Identity_Context",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Assemble_Galaxy_Identity_Context": {
      "main": [
        [
          {
            "node": "Forge_Galaxy_Identity",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Forge_Galaxy_Identity": {
      "main": [
        [
          {
            "node": "Persist_Galaxy_Core_Profile",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Persist_Galaxy_Core_Profile": {
      "main": [
        [
          {
            "node": "Dispatch_Galaxy_Notice_Primary",
            "type": "main",
            "index": 0
          },
          {
            "node": "Dispatch_Galaxy_Notice_Guardian",
            "type": "main",
            "index": 0
          },
          {
            "node": "Dispatch_Galaxy_Notice_Administration",
            "type": "main",
            "index": 0
          },
          {
            "node": "Persist_Galaxy_Attendance_Registry",
            "type": "main",
            "index": 0
          },
          {
            "node": "Persist_Galaxy_Financial_Ledger",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CODE_Attendance_Command_Resolver": {
      "main": [
        [
          {
            "node": "HTTP ‚ñ∏ Galaxy Row Sentinel",
            "type": "main",
            "index": 0
          },
          {
            "node": "MERGE ‚ñ∏ Attendance Context Unifier",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "CRON_Monthly_Attendance_Init": {
      "main": [
        [
          {
            "node": "TEMPORAL_ATTENDANCE_CONTEXT_ENGINE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP ‚ñ∏ Attendance Header Sentinel": {
      "main": [
        [
          {
            "node": "ATTENDANCE_SCHEMA_DIFFERENCE_ENGINE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CLASS_ORCHESTRATOR_MATRIX": {
      "main": [
        [
          {
            "node": "ACADEMIC_SCHEMA_FUSION_CORE",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ATTENDANCE_SCHEMA_DIFFERENCE_ENGINE": {
      "main": [
        [
          {
            "node": "HTTP ‚ñ∏ Attendance Column Architect",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ACADEMIC_SCHEMA_FUSION_CORE": {
      "main": [
        [
          {
            "node": "HTTP ‚ñ∏ Attendance Header Sentinel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TEMPORAL_ATTENDANCE_CONTEXT_ENGINE": {
      "main": [
        [
          {
            "node": "ATTENDANCE_SCHEMA_COMPOSER",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ATTENDANCE_SCHEMA_COMPOSER": {
      "main": [
        [
          {
            "node": "CLASS_ORCHESTRATOR_MATRIX",
            "type": "main",
            "index": 0
          },
          {
            "node": "ACADEMIC_SCHEMA_FUSION_CORE",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "HTTP ‚ñ∏ Galaxy Row Sentinel": {
      "main": [
        [
          {
            "node": "MERGE ‚ñ∏ Attendance Context Unifier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "‚Üí HTTP ‚ñ∏ Attendance Batch Writer": {
      "main": [
        [
          {
            "node": "IF ‚ñ∏ Attendance Write Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CODE ‚ñ∏ Attendance Batch Builder": {
      "main": [
        [
          {
            "node": "‚Üí HTTP ‚ñ∏ Attendance Batch Writer",
            "type": "main",
            "index": 0
          },
          {
            "node": "MERGE ‚ñ∏ Success Attendance Context",
            "type": "main",
            "index": 1
          },
          {
            "node": "MERGE ‚ñ∏ Failed Attendance Context",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "MERGE ‚ñ∏ Attendance Context Unifier": {
      "main": [
        [
          {
            "node": "CODE ‚ñ∏ Attendance Batch Builder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF ‚ñ∏ Attendance Write Status": {
      "main": [
        [
          {
            "node": "MERGE ‚ñ∏ Success Attendance Context",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "MERGE ‚ñ∏ Failed Attendance Context",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MERGE ‚ñ∏ Success Attendance Context": {
      "main": [
        [
          {
            "node": "Attendance Recorded Successfully",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MERGE ‚ñ∏ Failed Attendance Context": {
      "main": [
        [
          {
            "node": "Attendance Submission Failed",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CRON ‚ñ∏ Daily Holiday Scanner (11AM)": {
      "main": [
        [
          {
            "node": "CODE ‚ñ∏ Holiday Column Resolver",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CODE ‚ñ∏ Holiday Column Resolver": {
      "main": [
        [
          {
            "node": "HTTP ‚ñ∏ Holiday Auto Writer",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP ‚ñ∏ Holiday Auto Writer": {
      "main": [
        [
          {
            "node": "IF ‚ñ∏ Holiday Applied?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF ‚ñ∏ Holiday Applied?": {
      "main": [
        [
          {
            "node": "EMAIL ‚ñ∏ Admin Holiday Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP ‚ñ∏ Monthly Aggregation Engine": {
      "main": [
        [
          {
            "node": "IF ‚ñ∏ Aggregation Success Check",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CRON ‚ñ∏ Monthly Aggregation Trigger": {
      "main": [
        [
          {
            "node": "Code in JavaScript",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP ‚ñ∏ Fetch Monthly Student Data": {
      "main": [
        [
          {
            "node": "CODE ‚Üí Pipeline Router",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript": {
      "main": [
        [
          {
            "node": "HTTP ‚ñ∏ Monthly Aggregation Engine",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "CODE ‚Üí Pipeline Router": {
      "main": [
        [
          {
            "node": "SWITCH ‚Üí Pipeline Router",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SWITCH ‚Üí Pipeline Router": {
      "main": [
        [
          {
            "node": "Presence Fidelity Score (PFS)",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "1.Mail Payload Synthesizer + Identity Guard",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "1.1.Mail Payload Synthesizer + Identity Guard",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code in JavaScript1": {
      "main": [
        [
          {
            "node": "HTTP ‚ñ∏ Fetch Monthly Student Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger + Month Config Code Node": {
      "main": [
        [
          {
            "node": "Code in JavaScript1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Presence Fidelity Score (PFS)": {
      "main": [
        [
          {
            "node": "EDUVŒõULT Command & Analytics Channel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1.Mail Payload Synthesizer + Identity Guard": {
      "main": [
        [
          {
            "node": "Personal Academic Presence Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1.1.Mail Payload Synthesizer + Identity Guard": {
      "main": [
        [
          {
            "node": "EDUVŒõULT Guardian Visibility Channel",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sequential Dispatch Engine": {
      "main": [
        [],
        [
          {
            "node": "1.Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Sequential Dispatch Engine1": {
      "main": [
        [],
        [
          {
            "node": "1.1.Replace Me",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1.Replace Me": {
      "main": [
        [
          {
            "node": "Sequential Dispatch Engine",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1.1.Replace Me": {
      "main": [
        [
          {
            "node": "Sequential Dispatch Engine1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "EDUVŒõULT | Galaxy Identity Resolution Engine (GIRE)": {
      "main": [
        [
          {
            "node": "Lifecycle State Gatekeeper",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Lifecycle State Gatekeeper": {
      "main": [
        [
          {
            "node": "1.2.Persist_Galaxy_Financial_Ledger",
            "type": "main",
            "index": 0
          },
          {
            "node": "1.2.Persist_Galaxy_Attendance_Registry",
            "type": "main",
            "index": 0
          },
          {
            "node": "1.2.Persist_Galaxy_Core_Profile",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "1.1.Persist_Galaxy_Core_Profile",
            "type": "main",
            "index": 0
          },
          {
            "node": "1.1.Persist_Galaxy_Financial_Ledger",
            "type": "main",
            "index": 0
          },
          {
            "node": "1.1.Persist_Galaxy_Attendance_Registry",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Financial_Delinquency_Aggregator": {
      "main": [
        [
          {
            "node": "Send message2",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gmail_Send_FINAL_Report_Admin",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Column_Namespace_Compiler1": {
      "main": [
        [
          {
            "node": "Generate Class List",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Normalize_Broadcast_Command": {
      "main": [
        [
          {
            "node": "Split_Target_Classes",
            "type": "main",
            "index": 0
          },
          {
            "node": "Remove_Classes_Array",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split_Target_Classes": {
      "main": [
        [
          {
            "node": "HTTP_Fetch_Class_Student_Registry",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP_Fetch_Class_Student_Registry": {
      "main": [
        [
          {
            "node": "Split_Students_Per_Recipient",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Remove_Classes_Array": {
      "main": [
        [
          {
            "node": "Merge_Student_With_Broadcast_Context",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Build_Audience_Routing_Envelope": {
      "main": [
        [
          {
            "node": "IF_Target_Audience_Router",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_Target_Audience_Router": {
      "main": [
        [
          {
            "node": "Code_Parents_Detect_Send_Or_Missing",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code_Students_Detect_Send_Or_Missing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Student Notification Dispatch": {
      "main": [
        [
          {
            "node": "1.1.Code_Combine_Admin_Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Parent Notification Dispatch": {
      "main": [
        [
          {
            "node": "1.Code_Combine_Admin_Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Detect_Input_Type": {
      "main": [
        [
          {
            "node": "IF_Raw_Text_Input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_Raw_Text_Input": {
      "main": [
        [
          {
            "node": "AI_Message_Polisher",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Merge_Polished_Message_With_Context",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "AI_Message_Polisher": {
      "main": [
        [
          {
            "node": "Merge_Polished_Message_With_Context",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge_Polished_Message_With_Context": {
      "main": [
        [
          {
            "node": "Normalize_Broadcast_Command",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge_Student_With_Broadcast_Context": {
      "main": [
        [
          {
            "node": "Build_Audience_Routing_Envelope",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split_Students_Per_Recipient": {
      "main": [
        [
          {
            "node": "Merge_Student_With_Broadcast_Context",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code_Parents_Detect_Send_Or_Missing": {
      "main": [
        [
          {
            "node": "1.IF_Mode_Is_SEND",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code_Students_Detect_Send_Or_Missing": {
      "main": [
        [
          {
            "node": "1.1.IF_Mode_Is_SEND",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1.IF_Mode_Is_SEND": {
      "main": [
        [
          {
            "node": "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Parent Notification Dispatch",
            "type": "main",
            "index": 0
          },
          {
            "node": "1.Code_Combine_Admin_Report",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "1.Code_Combine_Admin_Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1.1.IF_Mode_Is_SEND": {
      "main": [
        [
          {
            "node": "1.1.Code_Combine_Admin_Report",
            "type": "main",
            "index": 0
          },
          {
            "node": "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Student Notification Dispatch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "1.1.Code_Combine_Admin_Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1.1.Code_Combine_Admin_Report": {
      "main": [
        [
          {
            "node": "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Admin ‚ñ∏ Students Dispatch Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "1.Code_Combine_Admin_Report": {
      "main": [
        [
          {
            "node": "GMAIL ‚ñ∏ EDUVŒõULT ‚ñ∏ Admin ‚ñ∏ Parents Dispatch Report",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Forge_Fee_Transaction_Payload1": {
      "main": [
        [
          {
            "node": "Prepare_Fee_Fetch_Payload",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Prepare_Fee_Fetch_Payload": {
      "main": [
        [
          {
            "node": "HTTP_Fetch_Fee_Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP_Fetch_Fee_Data": {
      "main": [
        [
          {
            "node": "IF_Fee_Eligibility_OK",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "IF_Fee_Eligibility_OK": {
      "main": [
        [
          {
            "node": "Generate_Receipt_ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate_Receipt_ID": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare_Ledger_Write_Payload": {
      "main": [
        [
          {
            "node": "HTTP_Write_Fee_Ledger",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP_Write_Fee_Ledger": {
      "main": [
        [
          {
            "node": "1.Gmail_Send_FEE_CONFIRMATION_Parent",
            "type": "main",
            "index": 0
          },
          {
            "node": "1.2.Gmail_Send_FEE_CONFIRMATION_Student",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Prepare_Ledger_Write_Payload",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Month Label1": {
      "main": [
        [
          {
            "node": "Forge_Class_Execution_Context1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Unified_Context_Convergence_Core1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Forge_Class_Execution_Context1": {
      "main": [
        [
          {
            "node": "Unified_Context_Convergence_Core1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Temporal_Execution_Trigger1": {
      "main": [
        [
          {
            "node": "Prepare Month Label1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Unified_Context_Convergence_Core1": {
      "main": [
        [
          {
            "node": "Column_Namespace_Compiler2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Column_Namespace_Compiler2": {
      "main": [
        [
          {
            "node": "Temporal_Clo_Schema_Injector1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "EDUVAULT‚ñ∏Authorized_Student_Lifecycle_State_Management_Portal": {
      "main": [
        [
          {
            "node": "EDUVŒõULT | Galaxy Identity Resolution Engine (GIRE)",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "EDUVAULT‚ñ∏Admin_Broadcast_Command_Portal": {
      "main": [
        [
          {
            "node": "Detect_Input_Type",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "EDUVAULT‚ñ∏ Attendance_Submission_Interface_Portal": {
      "main": [
        [
          {
            "node": "CODE_Attendance_Command_Resolver",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "EDUVAULT‚ñ∏Fee_Ingress_Gateway_Portal": {
      "main": [
        [
          {
            "node": "Forge_Fee_Transaction_Payload1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "EDUVAULT‚ñ∏Galaxy_Identity_Intake_Portal": {
      "main": [
        [
          {
            "node": "Normalize_Galaxy_Intake_Payload",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Send message2": {
      "main": [
        [
          {
            "node": "Gmail_Send_FINAL_Report_Admin",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false,
    "timeSavedMode": "fixed",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "7d6611d9-dc22-4127-8f5e-65ec3ec1cea3",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "aa45641c7fb8a46f211df7fe8b6c216bbb8863bdbcadd5d8bb212bb3b95767ec"
  },
  "id": "U1_Pozdks0snRFVjhKBEL",
  "tags": []
}